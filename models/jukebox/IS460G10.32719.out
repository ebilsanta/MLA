You are allocated NVIDIA GeForce RTX 3090 on toga
You are using GPU 0
1
Using cuda True
1
0: Found 1 files. Getting durations
0: self.sr=44100, min: 9, max: inf
0: Keeping 1 of 1 files
0: Found 1 files. Getting durations
0: self.sr=44100, min: 9, max: inf
0: Keeping 1 of 1 files
{'l2': 0.013910161453286572, 'l1': 0.08383325735727946, 'spec': 3550.98095703125}
Creating Data Loader
Creating Data Loaders for Stem Dataset
0: Train 20 samples. Test 3 samples
0: Train sampler: <torch.utils.data.distributed.DistributedSampler object at 0x7f5498d68b90>
0: Train loader: 3
0: Train 20 stem samples. Test 3 stem samples
0: Stem train sampler: <torch.utils.data.distributed.DistributedSampler object at 0x7f5498d68c10>
0: Stem train loader: 3
Model from scratch
0: Loading vqvae in train mode
0: Reseting bottleneck emas
Parameters VQVAE:900033
Downloading from azure
Restored from /common/home/projectgrps/IS460/IS460G10/.cache/jukebox/models/5b/vqvae.pth.tar
Number of gpus:
1
Logging to logs/new_vqvae_test_b6
Epoch:  -1 / 350
/common/home/projectgrps/IS460/IS460G10/miniconda3/envs/unmix/lib/python3.7/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 6 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
tensor([[[ 0.0241,  0.0241],
         [ 0.0258,  0.0258],
         [ 0.0291,  0.0291],
         ...,
         [-0.0581, -0.0581],
         [-0.0461, -0.0461],
         [-0.0383, -0.0383]],

        [[ 0.0352,  0.0352],
         [ 0.0125,  0.0125],
         [-0.0077, -0.0077],
         ...,
         [ 0.0012,  0.0012],
         [ 0.0011,  0.0011],
         [ 0.0020,  0.0020]],

        [[-0.0626, -0.0626],
         [-0.0895, -0.0895],
         [-0.1147, -0.1147],
         ...,
         [-0.1732, -0.1732],
         [-0.1683, -0.1683],
         [-0.1584, -0.1584]],

        [[ 0.1400,  0.1400],
         [ 0.1482,  0.1482],
         [ 0.1644,  0.1644],
         ...,
         [ 0.2061,  0.2061],
         [ 0.2109,  0.2109],
         [ 0.1957,  0.1957]],

        [[ 0.0369,  0.0369],
         [ 0.0346,  0.0346],
         [ 0.0310,  0.0310],
         ...,
         [ 0.1646,  0.1646],
         [ 0.1377,  0.1377],
         [ 0.0954,  0.0954]],

        [[ 0.0073,  0.0073],
         [ 0.0048,  0.0048],
         [-0.0007, -0.0007],
         ...,
         [-0.0229, -0.0229],
         [-0.0161, -0.0161],
         [-0.0129, -0.0129]]])
tensor([[[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 1.3580e-02,  1.3580e-02],
         [ 1.2787e-02,  1.2787e-02],
         [ 1.1749e-02,  1.1749e-02]],

        [[ 4.5288e-02,  4.5288e-02],
         [ 4.2908e-02,  4.2908e-02],
         [ 3.7231e-02,  3.7231e-02],
         ...,
         [-3.4637e-02, -3.4637e-02],
         [-2.8412e-02, -2.8412e-02],
         [-2.5513e-02, -2.5513e-02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-8.8806e-03, -8.8806e-03],
         [-1.3428e-02, -1.3428e-02],
         [-1.1719e-02, -1.1719e-02]],

        [[ 1.3611e-02,  1.3611e-02],
         [ 1.2024e-02,  1.2024e-02],
         [ 1.0712e-02,  1.0712e-02],
         ...,
         [-5.5542e-03, -5.5542e-03],
         [-7.7209e-03, -7.7209e-03],
         [-1.0132e-02, -1.0132e-02]],

        [[ 9.5215e-03,  9.5215e-03],
         [ 1.4313e-02,  1.4313e-02],
         [ 2.2064e-02,  2.2064e-02],
         ...,
         [ 2.2247e-02,  2.2247e-02],
         [ 2.3560e-02,  2.3560e-02],
         [ 2.3590e-02,  2.3590e-02]],

        [[ 4.5898e-02,  4.5898e-02],
         [ 4.6417e-02,  4.6417e-02],
         [ 4.5990e-02,  4.5990e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00],
         [-3.0518e-05, -3.0518e-05]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0140, -0.0140],
         [-0.0142, -0.0142],
         [-0.0116, -0.0116],
         ...,
         [ 0.0574,  0.0574],
         [ 0.0732,  0.0732],
         [ 0.0837,  0.0837]],

        [[-0.0384, -0.0384],
         [-0.0350, -0.0350],
         [-0.0348, -0.0348],
         ...,
         [ 0.1337,  0.1337],
         [ 0.0943,  0.0943],
         [ 0.0616,  0.0616]],

        [[ 0.1484,  0.1484],
         [ 0.1564,  0.1564],
         [ 0.1617,  0.1617],
         ...,
         [ 0.0063,  0.0063],
         [ 0.0029,  0.0029],
         [ 0.0026,  0.0026]],

        [[-0.0078, -0.0078],
         [ 0.0077,  0.0077],
         [ 0.0216,  0.0216],
         ...,
         [-0.0082, -0.0082],
         [-0.0085, -0.0085],
         [-0.0106, -0.0106]],

        [[-0.0649, -0.0649],
         [-0.0714, -0.0714],
         [-0.0865, -0.0865],
         ...,
         [ 0.0167,  0.0167],
         [ 0.0135,  0.0135],
         [-0.0102, -0.0102]],

        [[ 0.0179,  0.0179],
         [ 0.0036,  0.0036],
         [-0.0139, -0.0139],
         ...,
         [ 0.0057,  0.0057],
         [ 0.0067,  0.0067],
         [ 0.0072,  0.0072]]])
Y istensor([[[-1.8677e-02, -1.8677e-02],
         [-1.6998e-02, -1.6998e-02],
         [-1.5259e-02, -1.5259e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 5.2368e-02,  5.2368e-02],
         [ 4.7943e-02,  4.7943e-02],
         [ 4.5715e-02,  4.5715e-02]],

        [[ 1.8616e-03,  1.8616e-03],
         [-1.0376e-03, -1.0376e-03],
         [-2.8076e-03, -2.8076e-03],
         ...,
         [ 1.4951e-01,  1.4951e-01],
         [ 1.6379e-01,  1.6379e-01],
         [ 1.7093e-01,  1.7093e-01]],

        [[-2.1057e-02, -2.1057e-02],
         [-2.2125e-02, -2.2125e-02],
         [-2.3071e-02, -2.3071e-02],
         ...,
         [-1.1475e-02, -1.1475e-02],
         [-1.0132e-02, -1.0132e-02],
         [-9.8572e-03, -9.8572e-03]],

        [[ 1.6113e-02,  1.6113e-02],
         [-8.2092e-03, -8.2092e-03],
         [-3.5187e-02, -3.5187e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]]])
Logging train inputs/ouputs
1/? [00:12<00:00, 12.26s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0098, -0.0098],
         [-0.0042, -0.0042],
         [-0.0208, -0.0208],
         ...,
         [-0.0160, -0.0160],
         [ 0.0075,  0.0075],
         [-0.0377, -0.0377]],

        [[ 0.0138,  0.0138],
         [ 0.0173,  0.0173],
         [ 0.0069,  0.0069],
         ...,
         [ 0.1172,  0.1172],
         [ 0.1566,  0.1566],
         [ 0.1852,  0.1852]],

        [[-0.0558, -0.0558],
         [-0.0605, -0.0605],
         [-0.0641, -0.0641],
         ...,
         [-0.2488, -0.2488],
         [-0.2210, -0.2210],
         [-0.1848, -0.1848]],

        [[-0.0422, -0.0422],
         [-0.0390, -0.0390],
         [-0.0348, -0.0348],
         ...,
         [ 0.1456,  0.1456],
         [ 0.1648,  0.1648],
         [ 0.1802,  0.1802]],

        [[ 0.0291,  0.0291],
         [ 0.0314,  0.0314],
         [ 0.0351,  0.0351],
         ...,
         [-0.0523, -0.0523],
         [-0.0634, -0.0634],
         [-0.0721, -0.0721]],

        [[-0.2047, -0.2047],
         [-0.2130, -0.2130],
         [-0.2160, -0.2160],
         ...,
         [ 0.0826,  0.0826],
         [ 0.0970,  0.0970],
         [ 0.1022,  0.1022]]])
Y istensor([[[ 8.9111e-03,  8.9111e-03],
         [ 6.8359e-03,  6.8359e-03],
         [ 4.7302e-03,  4.7302e-03],
         ...,
         [-5.2521e-02, -5.2521e-02],
         [-5.1239e-02, -5.1239e-02],
         [-4.9377e-02, -4.9377e-02]],

        [[-2.9358e-02, -2.9358e-02],
         [-3.2990e-02, -3.2990e-02],
         [-3.6163e-02, -3.6163e-02],
         ...,
         [ 1.8585e-02,  1.8585e-02],
         [ 2.0569e-02,  2.0569e-02],
         [ 2.2247e-02,  2.2247e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 8.9417e-03,  8.9417e-03],
         [ 1.0803e-02,  1.0803e-02],
         [ 1.1627e-02,  1.1627e-02]],

        [[ 3.3508e-02,  3.3508e-02],
         [ 3.4515e-02,  3.4515e-02],
         [ 3.4729e-02,  3.4729e-02],
         ...,
         [ 8.9508e-02,  8.9508e-02],
         [ 8.0109e-02,  8.0109e-02],
         [ 7.1991e-02,  7.1991e-02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-5.3101e-03, -5.3101e-03],
         [-5.0049e-03, -5.0049e-03],
         [-5.7983e-03, -5.7983e-03]],

        [[-3.6713e-02, -3.6713e-02],
         [-2.9663e-02, -2.9663e-02],
         [-2.3376e-02, -2.3376e-02],
         ...,
         [ 8.6670e-03,  8.6670e-03],
         [ 8.2397e-03,  8.2397e-03],
         [ 7.7209e-03,  7.7209e-03]]])
2/? [00:13<00:00,  8.86s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 3.9276e-02,  3.9276e-02],
         [ 7.2571e-02,  7.2571e-02],
         [ 9.5947e-02,  9.5947e-02],
         ...,
         [ 1.4606e-01,  1.4606e-01],
         [ 1.5732e-01,  1.5732e-01],
         [ 1.7532e-01,  1.7532e-01]],

        [[-8.5510e-02, -8.5510e-02],
         [-6.1493e-02, -6.1493e-02],
         [-4.4037e-02, -4.4037e-02],
         ...,
         [ 4.9622e-02,  4.9622e-02],
         [ 4.6356e-02,  4.6356e-02],
         [ 4.4128e-02,  4.4128e-02]],

        [[-6.3354e-02, -6.3354e-02],
         [-3.2593e-02, -3.2593e-02],
         [ 1.4374e-02,  1.4374e-02],
         ...,
         [-6.1035e-05, -6.1035e-05],
         [ 2.3193e-03,  2.3193e-03],
         [ 3.8452e-03,  3.8452e-03]],

        [[-9.0179e-02, -9.0179e-02],
         [-7.7850e-02, -7.7850e-02],
         [-6.1707e-02, -6.1707e-02],
         ...,
         [ 9.9823e-02,  9.9823e-02],
         [ 1.0794e-01,  1.0794e-01],
         [ 1.1420e-01,  1.1420e-01]],

        [[ 1.5320e-02,  1.5320e-02],
         [-1.5717e-02, -1.5717e-02],
         [-5.7373e-02, -5.7373e-02],
         ...,
         [-7.6294e-04, -7.6294e-04],
         [ 2.2888e-03,  2.2888e-03],
         [ 2.8076e-03,  2.8076e-03]],

        [[ 2.5574e-02,  2.5574e-02],
         [ 2.3407e-02,  2.3407e-02],
         [ 2.0233e-02,  2.0233e-02],
         ...,
         [ 9.5306e-02,  9.5306e-02],
         [ 9.5245e-02,  9.5245e-02],
         [ 9.5367e-02,  9.5367e-02]]])
Y istensor([[[-5.0354e-02, -5.0354e-02],
         [-5.0018e-02, -5.0018e-02],
         [-4.9866e-02, -4.9866e-02],
         ...,
         [-5.2979e-02, -5.2979e-02],
         [-4.8523e-02, -4.8523e-02],
         [-4.3518e-02, -4.3518e-02]],

        [[ 1.9257e-02,  1.9257e-02],
         [ 2.0844e-02,  2.0844e-02],
         [ 2.2430e-02,  2.2430e-02],
         ...,
         [-2.7130e-02, -2.7130e-02],
         [-2.0996e-02, -2.0996e-02],
         [-1.3550e-02, -1.3550e-02]],

        [[ 9.4604e-04,  9.4604e-04],
         [ 8.8501e-04,  8.8501e-04],
         [ 8.5449e-04,  8.5449e-04],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 5.4047e-02,  5.4047e-02],
         [ 4.8035e-02,  4.8035e-02],
         [ 2.9663e-02,  2.9663e-02],
         ...,
         [-5.2490e-03, -5.2490e-03],
         [ 6.5613e-03,  6.5613e-03],
         [ 6.8054e-03,  6.8054e-03]],

        [[ 2.3743e-02,  2.3743e-02],
         [ 2.4689e-02,  2.4689e-02],
         [ 2.4658e-02,  2.4658e-02],
         ...,
         [ 1.1658e-02,  1.1658e-02],
         [ 6.2866e-03,  6.2866e-03],
         [-4.9438e-03, -4.9438e-03]],

        [[ 2.1362e-04,  2.1362e-04],
         [-1.7090e-03, -1.7090e-03],
         [-1.8005e-03, -1.8005e-03],
         ...,
         [ 6.1035e-05,  6.1035e-05],
         [ 6.1035e-05,  6.1035e-05],
         [ 0.0000e+00,  0.0000e+00]]])
3/? [00:14<00:00,  6.48s/it]3/? [00:14<00:00,  4.72s/it]
Train recons_loss_l1: 0.9741 spectral_loss_l1: 1.0589 multispectral_loss_l1: 0.6779 recons_loss: 0.9741 spectral_loss: 1.0589 multispectral_loss: 0.6779 spectral_convergence: 3.6081 l2_loss: 0.8307 l1_loss: 1.0626 linf_loss: 7.1701 commit_loss: 0.0125 fit: 0.8026 pn: 0.1881 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0014 loss: 1.6522 gn: 38.0544 lr: 0.0000 lg_loss_scale: 0.0000 epoch: -1.0000
Epoch:  0 / 350
/common/home/projectgrps/IS460/IS460G10/miniconda3/envs/unmix/lib/python3.7/site-packages/torch/functional.py:633: UserWarning: stft will soon require the return_complex parameter be given for real inputs, and will further require that return_complex=True in a future PyTorch release. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541035/work/aten/src/ATen/native/SpectralOps.cpp:801.)
  normalized, onesided, return_complex)
/common/home/projectgrps/IS460/IS460G10/miniconda3/envs/unmix/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:257: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  warnings.warn("To get the last learning rate computed by the scheduler, "
/common/home/projectgrps/IS460/IS460G10/jukebox/unmix/utils/ema.py:78: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541035/work/torch/csrc/utils/python_arg_parser.cpp:1420.)
  self.state[group].mul_(self.mu).add_(1 - self.mu, self.get_model_state(group))
tensor([[[-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [-1.6098e-01, -1.6098e-01],
         [-1.4780e-01, -1.4780e-01],
         [-1.3864e-01, -1.3864e-01]],

        [[ 6.3751e-02,  6.3751e-02],
         [ 6.0455e-02,  6.0455e-02],
         [ 4.9225e-02,  4.9225e-02],
         ...,
         [-7.2021e-03, -7.2021e-03],
         [-6.8054e-03, -6.8054e-03],
         [-5.4626e-03, -5.4626e-03]],

        [[ 2.5604e-02,  2.5604e-02],
         [ 7.4249e-02,  7.4249e-02],
         [ 9.6497e-02,  9.6497e-02],
         ...,
         [-1.5778e-02, -1.5778e-02],
         [-4.2511e-02, -4.2511e-02],
         [-7.3883e-02, -7.3883e-02]],

        [[ 2.2705e-02,  2.2705e-02],
         [ 2.6886e-02,  2.6886e-02],
         [ 3.2867e-02,  3.2867e-02],
         ...,
         [ 1.4944e-01,  1.4944e-01],
         [ 1.2521e-01,  1.2521e-01],
         [ 9.9976e-02,  9.9976e-02]],

        [[ 1.7731e-02,  1.7731e-02],
         [ 2.3376e-02,  2.3376e-02],
         [ 2.7527e-02,  2.7527e-02],
         ...,
         [ 7.0190e-04,  7.0190e-04],
         [ 3.3569e-04,  3.3569e-04],
         [ 2.4414e-04,  2.4414e-04]],

        [[ 1.9153e-01,  1.9153e-01],
         [ 1.7496e-01,  1.7496e-01],
         [ 1.5677e-01,  1.5677e-01],
         ...,
         [ 2.7133e-01,  2.7133e-01],
         [ 2.7036e-01,  2.7036e-01],
         [ 2.5824e-01,  2.5824e-01]]])
tensor([[[-2.0782e-02, -2.0782e-02],
         [-1.8005e-02, -1.8005e-02],
         [-1.5991e-02, -1.5991e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 6.2561e-03,  6.2561e-03],
         [ 7.7209e-03,  7.7209e-03],
         [ 9.0637e-03,  9.0637e-03],
         ...,
         [ 1.7883e-02,  1.7883e-02],
         [ 3.7933e-02,  3.7933e-02],
         [ 6.7474e-02,  6.7474e-02]],

        [[-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [ 1.1322e-02,  1.1322e-02],
         [ 1.5686e-02,  1.5686e-02],
         [ 5.1880e-03,  5.1880e-03]],

        [[ 6.0425e-03,  6.0425e-03],
         [ 7.4463e-03,  7.4463e-03],
         [ 9.6436e-03,  9.6436e-03],
         ...,
         [ 4.3304e-02,  4.3304e-02],
         [ 5.3131e-02,  5.3131e-02],
         [ 5.7098e-02,  5.7098e-02]],

        [[-1.1627e-02, -1.1627e-02],
         [-1.1963e-02, -1.1963e-02],
         [-1.2146e-02, -1.2146e-02],
         ...,
         [-9.1125e-02, -9.1125e-02],
         [-8.6884e-02, -8.6884e-02],
         [-7.9254e-02, -7.9254e-02]],

        [[ 3.6621e-04,  3.6621e-04],
         [ 2.2888e-03,  2.2888e-03],
         [ 2.3193e-03,  2.3193e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0402, -0.0402],
         [-0.0493, -0.0493],
         [-0.0592, -0.0592],
         ...,
         [-0.0025, -0.0025],
         [-0.0028, -0.0028],
         [-0.0027, -0.0027]],

        [[-0.1228, -0.1228],
         [-0.1031, -0.1031],
         [-0.0894, -0.0894],
         ...,
         [-0.0108, -0.0108],
         [-0.0039, -0.0039],
         [ 0.0004,  0.0004]],

        [[ 0.0780,  0.0780],
         [ 0.0930,  0.0930],
         [ 0.1097,  0.1097],
         ...,
         [ 0.0523,  0.0523],
         [-0.0087, -0.0087],
         [-0.0452, -0.0452]],

        [[-0.1916, -0.1916],
         [-0.2133, -0.2133],
         [-0.2309, -0.2309],
         ...,
         [-0.3428, -0.3428],
         [-0.3081, -0.3081],
         [-0.2651, -0.2651]],

        [[ 0.0927,  0.0927],
         [ 0.0269,  0.0269],
         [-0.0358, -0.0358],
         ...,
         [ 0.0649,  0.0649],
         [ 0.0701,  0.0701],
         [ 0.0757,  0.0757]],

        [[ 0.0203,  0.0203],
         [ 0.0103,  0.0103],
         [ 0.0022,  0.0022],
         ...,
         [ 0.1474,  0.1474],
         [ 0.0699,  0.0699],
         [ 0.0006,  0.0006]]])
Y istensor([[[ 0.0140,  0.0140],
         [ 0.0126,  0.0126],
         [ 0.0112,  0.0112],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]],

        [[ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         ...,
         [ 0.0242,  0.0242],
         [ 0.0151,  0.0151],
         [ 0.0042,  0.0042]],

        [[-0.0001, -0.0001],
         [-0.0001, -0.0001],
         [-0.0001, -0.0001],
         ...,
         [ 0.0070,  0.0070],
         [ 0.0146,  0.0146],
         [ 0.0155,  0.0155]],

        [[-0.0139, -0.0139],
         [-0.0142, -0.0142],
         [-0.0143, -0.0143],
         ...,
         [-0.0191, -0.0191],
         [-0.0199, -0.0199],
         [-0.0208, -0.0208]],

        [[ 0.0626,  0.0626],
         [ 0.0617,  0.0617],
         [ 0.0625,  0.0625],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]],

        [[ 0.0327,  0.0327],
         [ 0.0385,  0.0385],
         [ 0.0271,  0.0271],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]]])
1/? [00:02<00:00,  2.11s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.2265, -0.2265],
         [-0.2207, -0.2207],
         [-0.2062, -0.2062],
         ...,
         [-0.0179, -0.0179],
         [-0.0164, -0.0164],
         [-0.0131, -0.0131]],

        [[-0.0604, -0.0604],
         [-0.0769, -0.0769],
         [-0.0950, -0.0950],
         ...,
         [-0.2045, -0.2045],
         [-0.1797, -0.1797],
         [-0.1514, -0.1514]],

        [[ 0.0782,  0.0782],
         [ 0.0935,  0.0935],
         [ 0.1111,  0.1111],
         ...,
         [ 0.1436,  0.1436],
         [ 0.1420,  0.1420],
         [ 0.1239,  0.1239]],

        [[-0.1255, -0.1255],
         [-0.0842, -0.0842],
         [-0.0477, -0.0477],
         ...,
         [ 0.0084,  0.0084],
         [-0.0016, -0.0016],
         [-0.0009, -0.0009]],

        [[-0.0052, -0.0052],
         [-0.0038, -0.0038],
         [-0.0026, -0.0026],
         ...,
         [-0.1174, -0.1174],
         [-0.0859, -0.0859],
         [-0.0669, -0.0669]],

        [[-0.0966, -0.0966],
         [-0.1205, -0.1205],
         [-0.1431, -0.1431],
         ...,
         [-0.0694, -0.0694],
         [-0.0841, -0.0841],
         [-0.0962, -0.0962]]])
Y istensor([[[-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 3.4790e-03,  3.4790e-03],
         [ 2.4109e-03,  2.4109e-03],
         [ 2.1362e-04,  2.1362e-04],
         ...,
         [ 5.8899e-03,  5.8899e-03],
         [ 2.9602e-03,  2.9602e-03],
         [-1.4954e-03, -1.4954e-03]],

        [[-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [ 7.1747e-02,  7.1747e-02],
         [ 6.4056e-02,  6.4056e-02],
         [ 5.0629e-02,  5.0629e-02]],

        [[ 3.0518e-05,  3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-2.5238e-02, -2.5238e-02],
         [-2.7893e-02, -2.7893e-02],
         [-3.0304e-02, -3.0304e-02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-9.5825e-03, -9.5825e-03],
         [-1.0315e-02, -1.0315e-02],
         [-1.0712e-02, -1.0712e-02]],

        [[-1.1963e-02, -1.1963e-02],
         [-1.5625e-02, -1.5625e-02],
         [-1.9287e-02, -1.9287e-02],
         ...,
         [ 2.2888e-03,  2.2888e-03],
         [ 2.1057e-03,  2.1057e-03],
         [ 2.0447e-03,  2.0447e-03]]])
2/? [00:03<00:00,  1.76s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0131, -0.0131],
         [-0.0140, -0.0140],
         [-0.0171, -0.0171],
         ...,
         [-0.0651, -0.0651],
         [-0.0793, -0.0793],
         [-0.0914, -0.0914]],

        [[-0.0459, -0.0459],
         [-0.0349, -0.0349],
         [-0.0263, -0.0263],
         ...,
         [-0.0204, -0.0204],
         [-0.0433, -0.0433],
         [-0.0335, -0.0335]],

        [[ 0.0641,  0.0641],
         [ 0.0573,  0.0573],
         [ 0.0498,  0.0498],
         ...,
         [-0.0035, -0.0035],
         [ 0.0006,  0.0006],
         [ 0.0022,  0.0022]],

        [[ 0.0888,  0.0888],
         [ 0.0851,  0.0851],
         [ 0.0788,  0.0788],
         ...,
         [-0.3152, -0.3152],
         [-0.3165, -0.3165],
         [-0.3060, -0.3060]],

        [[-0.1379, -0.1379],
         [-0.1115, -0.1115],
         [-0.0684, -0.0684],
         ...,
         [ 0.1026,  0.1026],
         [ 0.0802,  0.0802],
         [ 0.0608,  0.0608]],

        [[-0.2326, -0.2326],
         [-0.2386, -0.2386],
         [-0.2466, -0.2466],
         ...,
         [-0.0088, -0.0088],
         [-0.0055, -0.0055],
         [ 0.0004,  0.0004]]])
Y istensor([[[ 3.9062e-02,  3.9062e-02],
         [ 4.9530e-02,  4.9530e-02],
         [ 5.7312e-02,  5.7312e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-5.5450e-02, -5.5450e-02],
         [-5.4413e-02, -5.4413e-02],
         [-5.5054e-02, -5.5054e-02],
         ...,
         [ 1.6602e-02,  1.6602e-02],
         [ 2.4139e-02,  2.4139e-02],
         [ 3.0914e-02,  3.0914e-02]],

        [[-8.7677e-02, -8.7677e-02],
         [-5.8075e-02, -5.8075e-02],
         [-3.8666e-02, -3.8666e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-3.6621e-03, -3.6621e-03],
         [-3.5400e-03, -3.5400e-03],
         [-3.6926e-03, -3.6926e-03],
         ...,
         [ 2.2217e-01,  2.2217e-01],
         [ 2.0349e-01,  2.0349e-01],
         [ 1.7703e-01,  1.7703e-01]],

        [[-3.0731e-02, -3.0731e-02],
         [-3.5919e-02, -3.5919e-02],
         [-2.5940e-02, -2.5940e-02],
         ...,
         [-7.6294e-03, -7.6294e-03],
         [-2.5635e-03, -2.5635e-03],
         [ 3.6621e-04,  3.6621e-04]],

        [[ 7.6294e-04,  7.6294e-04],
         [ 8.8501e-04,  8.8501e-04],
         [ 2.7771e-03,  2.7771e-03],
         ...,
         [ 6.1035e-05,  6.1035e-05],
         [ 0.0000e+00,  0.0000e+00],
         [-3.0518e-05, -3.0518e-05]]])
3/? [00:03<00:00,  1.51s/it]3/? [00:04<00:00,  1.36s/it]
Train recons_loss_l1: 0.8910 spectral_loss_l1: 1.0137 multispectral_loss_l1: 0.6490 recons_loss: 0.8910 spectral_loss: 1.0137 multispectral_loss: 0.6490 spectral_convergence: 3.7082 l2_loss: 0.7619 l1_loss: 1.0199 linf_loss: 6.4561 commit_loss: 0.0003 fit: 0.0187 pn: 0.1878 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0000 loss: 1.5400 gn: 36.9407 lr: 0.0000 lg_loss_scale: 0.0000 epoch: 0.0000
Epoch:  1 / 350
tensor([[[ 0.0005,  0.0005],
         [-0.0004, -0.0004],
         [-0.0008, -0.0008],
         ...,
         [-0.0677, -0.0677],
         [-0.0754, -0.0754],
         [-0.0840, -0.0840]],

        [[ 0.0403,  0.0403],
         [ 0.0443,  0.0443],
         [ 0.0454,  0.0454],
         ...,
         [-0.1066, -0.1066],
         [-0.0503, -0.0503],
         [ 0.0206,  0.0206]],

        [[ 0.0255,  0.0255],
         [ 0.0044,  0.0044],
         [ 0.0034,  0.0034],
         ...,
         [-0.0224, -0.0224],
         [-0.0017, -0.0017],
         [ 0.0201,  0.0201]],

        [[ 0.2163,  0.2163],
         [ 0.2324,  0.2324],
         [ 0.2378,  0.2378],
         ...,
         [ 0.2103,  0.2103],
         [ 0.2331,  0.2331],
         [ 0.2431,  0.2431]],

        [[ 0.0203,  0.0203],
         [ 0.0181,  0.0181],
         [ 0.0135,  0.0135],
         ...,
         [ 0.0232,  0.0232],
         [ 0.0428,  0.0428],
         [ 0.0603,  0.0603]],

        [[-0.0063, -0.0063],
         [ 0.0051,  0.0051],
         [ 0.0104,  0.0104],
         ...,
         [ 0.0786,  0.0786],
         [ 0.0431,  0.0431],
         [ 0.0184,  0.0184]]])
tensor([[[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-8.3008e-03, -8.3008e-03],
         [-8.8196e-03, -8.8196e-03],
         [-9.8267e-03, -9.8267e-03]],

        [[-5.7648e-02, -5.7648e-02],
         [-8.0109e-02, -8.0109e-02],
         [-1.0123e-01, -1.0123e-01],
         ...,
         [-1.7181e-02, -1.7181e-02],
         [-1.3245e-02, -1.3245e-02],
         [-9.1858e-03, -9.1858e-03]],

        [[-1.8576e-01, -1.8576e-01],
         [-2.1857e-01, -2.1857e-01],
         [-2.3730e-01, -2.3730e-01],
         ...,
         [-1.0922e-01, -1.0922e-01],
         [-1.1328e-01, -1.1328e-01],
         [-1.1523e-01, -1.1523e-01]],

        [[-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [ 9.8877e-03,  9.8877e-03],
         [ 1.0193e-02,  1.0193e-02],
         [ 9.9182e-03,  9.9182e-03]],

        [[ 1.2939e-02,  1.2939e-02],
         [ 1.1780e-02,  1.1780e-02],
         [ 1.0925e-02,  1.0925e-02],
         ...,
         [ 1.1261e-02,  1.1261e-02],
         [ 7.4768e-03,  7.4768e-03],
         [ 5.2795e-03,  5.2795e-03]],

        [[ 5.4626e-03,  5.4626e-03],
         [ 2.6794e-02,  2.6794e-02],
         [ 2.0630e-02,  2.0630e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.1335, -0.1335],
         [-0.1506, -0.1506],
         [-0.1487, -0.1487],
         ...,
         [ 0.1021,  0.1021],
         [ 0.0983,  0.0983],
         [ 0.0933,  0.0933]],

        [[ 0.0134,  0.0134],
         [ 0.0041,  0.0041],
         [ 0.0071,  0.0071],
         ...,
         [ 0.1089,  0.1089],
         [ 0.0303,  0.0303],
         [-0.0846, -0.0846]],

        [[-0.1273, -0.1273],
         [-0.0866, -0.0866],
         [-0.0555, -0.0555],
         ...,
         [ 0.0010,  0.0010],
         [ 0.0131,  0.0131],
         [ 0.0240,  0.0240]],

        [[ 0.0015,  0.0015],
         [ 0.0014,  0.0014],
         [ 0.0008,  0.0008],
         ...,
         [-0.0859, -0.0859],
         [-0.0452, -0.0452],
         [ 0.0011,  0.0011]],

        [[ 0.0037,  0.0037],
         [-0.0224, -0.0224],
         [-0.0292, -0.0292],
         ...,
         [-0.0874, -0.0874],
         [-0.1165, -0.1165],
         [-0.1439, -0.1439]],

        [[-0.0865, -0.0865],
         [-0.0926, -0.0926],
         [-0.0954, -0.0954],
         ...,
         [ 0.0716,  0.0716],
         [ 0.0874,  0.0874],
         [ 0.0973,  0.0973]]])
Y istensor([[[-1.6907e-02, -1.6907e-02],
         [-1.7426e-02, -1.7426e-02],
         [-1.7426e-02, -1.7426e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-5.6519e-02, -5.6519e-02],
         [-8.6975e-02, -8.6975e-02],
         [-1.0846e-01, -1.0846e-01],
         ...,
         [-1.3916e-02, -1.3916e-02],
         [-1.0895e-02, -1.0895e-02],
         [-7.1716e-03, -7.1716e-03]],

        [[-6.1035e-05, -6.1035e-05],
         [-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [-1.0440e-01, -1.0440e-01],
         [-1.0391e-01, -1.0391e-01],
         [-9.9884e-02, -9.9884e-02]],

        [[ 1.8921e-03,  1.8921e-03],
         [-2.6855e-03, -2.6855e-03],
         [-6.3477e-03, -6.3477e-03],
         ...,
         [ 3.8062e-01,  3.8062e-01],
         [ 4.0384e-01,  4.0384e-01],
         [ 4.1589e-01,  4.1589e-01]],

        [[-6.9855e-02, -6.9855e-02],
         [-1.0275e-01, -1.0275e-01],
         [-1.2756e-01, -1.2756e-01],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-1.6174e-02, -1.6174e-02],
         [ 2.1362e-03,  2.1362e-03],
         [ 2.3376e-02,  2.3376e-02],
         ...,
         [-4.3274e-02, -4.3274e-02],
         [-4.6112e-02, -4.6112e-02],
         [-5.5634e-02, -5.5634e-02]]])
1/? [00:01<00:00,  1.53s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0552,  0.0552],
         [ 0.0631,  0.0631],
         [ 0.0681,  0.0681],
         ...,
         [-0.1124, -0.1124],
         [-0.1035, -0.1035],
         [-0.0992, -0.0992]],

        [[-0.0925, -0.0925],
         [-0.0800, -0.0800],
         [-0.0603, -0.0603],
         ...,
         [ 0.0033,  0.0033],
         [ 0.0026,  0.0026],
         [ 0.0015,  0.0015]],

        [[ 0.0052,  0.0052],
         [ 0.0026,  0.0026],
         [-0.0002, -0.0002],
         ...,
         [-0.0475, -0.0475],
         [-0.0466, -0.0466],
         [-0.0437, -0.0437]],

        [[ 0.0229,  0.0229],
         [ 0.0217,  0.0217],
         [ 0.0241,  0.0241],
         ...,
         [ 0.0154,  0.0154],
         [ 0.0036,  0.0036],
         [ 0.0213,  0.0213]],

        [[ 0.0343,  0.0343],
         [ 0.0268,  0.0268],
         [ 0.0185,  0.0185],
         ...,
         [-0.1086, -0.1086],
         [-0.1345, -0.1345],
         [-0.1508, -0.1508]],

        [[-0.1091, -0.1091],
         [-0.1074, -0.1074],
         [-0.1030, -0.1030],
         ...,
         [ 0.0285,  0.0285],
         [ 0.0324,  0.0324],
         [ 0.0366,  0.0366]]])
Y istensor([[[ 2.7466e-03,  2.7466e-03],
         [ 4.7913e-03,  4.7913e-03],
         [ 6.5918e-03,  6.5918e-03],
         ...,
         [-3.1433e-03, -3.1433e-03],
         [-3.3875e-03, -3.3875e-03],
         [-3.6011e-03, -3.6011e-03]],

        [[-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-3.9398e-02, -3.9398e-02],
         [-3.4058e-02, -3.4058e-02],
         [-2.6276e-02, -2.6276e-02]],

        [[ 1.4252e-02,  1.4252e-02],
         [ 1.3336e-02,  1.3336e-02],
         [ 1.2634e-02,  1.2634e-02],
         ...,
         [-1.6174e-03, -1.6174e-03],
         [-1.2817e-03, -1.2817e-03],
         [-6.1035e-04, -6.1035e-04]],

        [[-3.7659e-02, -3.7659e-02],
         [-4.4373e-02, -4.4373e-02],
         [-4.9347e-02, -4.9347e-02],
         ...,
         [-6.1737e-02, -6.1737e-02],
         [-6.1432e-02, -6.1432e-02],
         [-5.6946e-02, -5.6946e-02]],

        [[ 9.5215e-03,  9.5215e-03],
         [ 1.2604e-02,  1.2604e-02],
         [ 1.1292e-02,  1.1292e-02],
         ...,
         [-1.2207e-04, -1.2207e-04],
         [-1.5259e-04, -1.5259e-04],
         [-2.1362e-04, -2.1362e-04]],

        [[ 2.0905e-02,  2.0905e-02],
         [ 2.5635e-02,  2.5635e-02],
         [ 3.0060e-02,  3.0060e-02],
         ...,
         [-3.6621e-04, -3.6621e-04],
         [-6.4087e-04, -6.4087e-04],
         [-8.5449e-04, -8.5449e-04]]])
2/? [00:02<00:00,  1.35s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 4.5776e-03,  4.5776e-03],
         [ 1.1597e-03,  1.1597e-03],
         [ 6.9275e-03,  6.9275e-03],
         ...,
         [-1.3580e-02, -1.3580e-02],
         [ 1.3092e-02,  1.3092e-02],
         [ 3.9917e-02,  3.9917e-02]],

        [[-6.1035e-05, -6.1035e-05],
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [-7.0190e-04, -7.0190e-04],
         [-7.6294e-04, -7.6294e-04],
         [-8.2397e-04, -8.2397e-04]],

        [[ 2.0566e-01,  2.0566e-01],
         [ 1.7032e-01,  1.7032e-01],
         [ 1.2643e-01,  1.2643e-01],
         ...,
         [ 6.3629e-02,  6.3629e-02],
         [ 6.6071e-02,  6.6071e-02],
         [ 6.8176e-02,  6.8176e-02]],

        [[ 3.4760e-02,  3.4760e-02],
         [ 3.8483e-02,  3.8483e-02],
         [ 3.9948e-02,  3.9948e-02],
         ...,
         [ 3.0893e-01,  3.0893e-01],
         [ 3.0051e-01,  3.0051e-01],
         [ 2.6883e-01,  2.6883e-01]],

        [[ 1.6071e-01,  1.6071e-01],
         [ 1.4758e-01,  1.4758e-01],
         [ 1.3171e-01,  1.3171e-01],
         ...,
         [ 4.5135e-02,  4.5135e-02],
         [ 4.5197e-02,  4.5197e-02],
         [ 4.5441e-02,  4.5441e-02]],

        [[-1.6199e-01, -1.6199e-01],
         [-1.1954e-01, -1.1954e-01],
         [-7.5409e-02, -7.5409e-02],
         ...,
         [-6.7139e-04, -6.7139e-04],
         [ 4.7333e-02,  4.7333e-02],
         [-6.9580e-03, -6.9580e-03]]])
Y istensor([[[-2.5269e-02, -2.5269e-02],
         [-2.6123e-02, -2.6123e-02],
         [-2.6672e-02, -2.6672e-02],
         ...,
         [-1.4557e-02, -1.4557e-02],
         [-2.4017e-02, -2.4017e-02],
         [-3.3966e-02, -3.3966e-02]],

        [[-1.7609e-02, -1.7609e-02],
         [-1.8555e-02, -1.8555e-02],
         [-1.9806e-02, -1.9806e-02],
         ...,
         [ 8.6700e-02,  8.6700e-02],
         [ 7.9865e-02,  7.9865e-02],
         [ 6.6315e-02,  6.6315e-02]],

        [[-3.3356e-02, -3.3356e-02],
         [-3.1097e-02, -3.1097e-02],
         [-1.9165e-02, -1.9165e-02],
         ...,
         [ 6.1035e-05,  6.1035e-05],
         [ 9.1553e-05,  9.1553e-05],
         [ 9.1553e-05,  9.1553e-05]],

        [[ 1.4038e-03,  1.4038e-03],
         [ 1.3428e-03,  1.3428e-03],
         [ 1.2817e-03,  1.2817e-03],
         ...,
         [-1.1261e-02, -1.1261e-02],
         [-1.1841e-02, -1.1841e-02],
         [-1.3977e-02, -1.3977e-02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-2.8381e-03, -2.8381e-03],
         [ 1.2360e-02,  1.2360e-02],
         [ 1.4984e-02,  1.4984e-02]],

        [[ 8.6670e-03,  8.6670e-03],
         [ 7.8125e-03,  7.8125e-03],
         [ 6.8665e-03,  6.8665e-03],
         ...,
         [ 9.1553e-05,  9.1553e-05],
         [ 1.8311e-04,  1.8311e-04],
         [ 1.8311e-04,  1.8311e-04]]])
3/? [00:03<00:00,  1.23s/it]3/? [00:03<00:00,  1.16s/it]
Train recons_loss_l1: 0.7432 spectral_loss_l1: 0.9112 multispectral_loss_l1: 0.5836 recons_loss: 0.7432 spectral_loss: 0.9112 multispectral_loss: 0.5836 spectral_convergence: 3.0503 l2_loss: 0.6274 l1_loss: 0.9213 linf_loss: 5.7861 commit_loss: 0.0004 fit: 0.0268 pn: 0.1871 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0000 loss: 1.3268 gn: 33.6349 lr: 0.0000 lg_loss_scale: 0.0000 epoch: 1.0000
Epoch:  2 / 350
tensor([[[ 1.0074e-01,  1.0074e-01],
         [ 1.3467e-01,  1.3467e-01],
         [ 1.5674e-01,  1.5674e-01],
         ...,
         [ 8.4534e-03,  8.4534e-03],
         [ 8.1482e-03,  8.1482e-03],
         [ 7.1411e-03,  7.1411e-03]],

        [[ 1.5564e-03,  1.5564e-03],
         [ 3.0518e-05,  3.0518e-05],
         [-1.4954e-03, -1.4954e-03],
         ...,
         [-8.5754e-03, -8.5754e-03],
         [-5.6091e-02, -5.6091e-02],
         [-8.9691e-02, -8.9691e-02]],

        [[ 7.0190e-04,  7.0190e-04],
         [ 2.2217e-02,  2.2217e-02],
         [ 4.2755e-02,  4.2755e-02],
         ...,
         [ 1.1566e-02,  1.1566e-02],
         [-1.4038e-03, -1.4038e-03],
         [ 1.5564e-03,  1.5564e-03]],

        [[-4.4067e-02, -4.4067e-02],
         [-4.7333e-02, -4.7333e-02],
         [-5.5786e-02, -5.5786e-02],
         ...,
         [ 6.2317e-02,  6.2317e-02],
         [ 9.7260e-02,  9.7260e-02],
         [ 1.2973e-01,  1.2973e-01]],

        [[-1.6876e-02, -1.6876e-02],
         [-4.8737e-02, -4.8737e-02],
         [-9.0881e-02, -9.0881e-02],
         ...,
         [ 1.4862e-02,  1.4862e-02],
         [ 1.2970e-02,  1.2970e-02],
         [ 1.5717e-02,  1.5717e-02]],

        [[ 6.2347e-02,  6.2347e-02],
         [ 8.8715e-02,  8.8715e-02],
         [ 1.0831e-01,  1.0831e-01],
         ...,
         [ 2.4109e-03,  2.4109e-03],
         [ 3.3569e-04,  3.3569e-04],
         [-2.1362e-04, -2.1362e-04]]])
tensor([[[ 9.7961e-03,  9.7961e-03],
         [ 9.1553e-03,  9.1553e-03],
         [ 8.4534e-03,  8.4534e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [-9.4604e-04, -9.4604e-04],
         [-9.1553e-04, -9.1553e-04],
         [-1.2207e-03, -1.2207e-03]],

        [[ 9.4879e-02,  9.4879e-02],
         [ 1.0843e-01,  1.0843e-01],
         [ 1.2161e-01,  1.2161e-01],
         ...,
         [-5.9204e-02, -5.9204e-02],
         [-4.6356e-02, -4.6356e-02],
         [-3.3875e-02, -3.3875e-02]],

        [[-3.5431e-02, -3.5431e-02],
         [-3.5614e-02, -3.5614e-02],
         [-3.5217e-02, -3.5217e-02],
         ...,
         [-1.2012e-01, -1.2012e-01],
         [-1.2576e-01, -1.2576e-01],
         [-1.3455e-01, -1.3455e-01]],

        [[ 3.7689e-02,  3.7689e-02],
         [ 5.5542e-02,  5.5542e-02],
         [ 7.5897e-02,  7.5897e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 5.6152e-03,  5.6152e-03],
         [ 5.9814e-03,  5.9814e-03],
         [ 2.7771e-03,  2.7771e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-6.1035e-05, -6.1035e-05],
         [ 5.1880e-04,  5.1880e-04],
         [ 4.8828e-04,  4.8828e-04],
         ...,
         [-1.8188e-02, -1.8188e-02],
         [-4.1199e-03, -4.1199e-03],
         [-1.3550e-02, -1.3550e-02]],

        [[ 4.0405e-02,  4.0405e-02],
         [ 3.7262e-02,  3.7262e-02],
         [ 2.5146e-02,  2.5146e-02],
         ...,
         [-2.3041e-02, -2.3041e-02],
         [ 1.3336e-02,  1.3336e-02],
         [ 4.2358e-02,  4.2358e-02]],

        [[ 2.0264e-02,  2.0264e-02],
         [-5.0964e-03, -5.0964e-03],
         [-3.2410e-02, -3.2410e-02],
         ...,
         [ 4.1504e-03,  4.1504e-03],
         [ 4.9133e-03,  4.9133e-03],
         [ 5.9204e-03,  5.9204e-03]],

        [[-1.3919e-01, -1.3919e-01],
         [-1.4017e-01, -1.4017e-01],
         [-1.2894e-01, -1.2894e-01],
         ...,
         [ 9.6985e-02,  9.6985e-02],
         [ 6.8268e-02,  6.8268e-02],
         [ 4.0894e-02,  4.0894e-02]],

        [[ 8.3313e-02,  8.3313e-02],
         [ 8.0688e-02,  8.0688e-02],
         [ 7.6538e-02,  7.6538e-02],
         ...,
         [-1.4651e-01, -1.4651e-01],
         [-1.4606e-01, -1.4606e-01],
         [-1.4365e-01, -1.4365e-01]],

        [[ 2.3682e-02,  2.3682e-02],
         [ 3.0060e-02,  3.0060e-02],
         [ 4.0100e-02,  4.0100e-02],
         ...,
         [ 3.1006e-02,  3.1006e-02],
         [ 1.3916e-02,  1.3916e-02],
         [-9.4299e-03, -9.4299e-03]]])
Y istensor([[[-5.8594e-03, -5.8594e-03],
         [-5.8594e-03, -5.8594e-03],
         [-5.9204e-03, -5.9204e-03],
         ...,
         [-1.5259e-04, -1.5259e-04],
         [-3.0518e-04, -3.0518e-04],
         [-5.4932e-04, -5.4932e-04]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-5.2795e-03, -5.2795e-03],
         [-6.4087e-03, -6.4087e-03],
         [-6.5308e-03, -6.5308e-03]],

        [[-7.7484e-02, -7.7484e-02],
         [-6.6010e-02, -6.6010e-02],
         [-4.7150e-02, -4.7150e-02],
         ...,
         [ 1.3275e-02,  1.3275e-02],
         [ 2.5024e-03,  2.5024e-03],
         [-5.5542e-03, -5.5542e-03]],

        [[-6.2012e-02, -6.2012e-02],
         [-6.3171e-02, -6.3171e-02],
         [-6.2378e-02, -6.2378e-02],
         ...,
         [-5.5725e-02, -5.5725e-02],
         [-4.1656e-02, -4.1656e-02],
         [-2.3560e-02, -2.3560e-02]],

        [[ 1.3904e-01,  1.3904e-01],
         [ 1.4420e-01,  1.4420e-01],
         [ 1.3416e-01,  1.3416e-01],
         ...,
         [-7.1960e-02, -7.1960e-02],
         [-4.1840e-02, -4.1840e-02],
         [-1.4557e-02, -1.4557e-02]],

        [[ 2.7161e-03,  2.7161e-03],
         [ 2.4719e-03,  2.4719e-03],
         [ 2.1973e-03,  2.1973e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]]])
1/? [00:01<00:00,  1.47s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0294, -0.0294],
         [-0.0310, -0.0310],
         [-0.0328, -0.0328],
         ...,
         [-0.1785, -0.1785],
         [-0.1723, -0.1723],
         [-0.1595, -0.1595]],

        [[-0.1686, -0.1686],
         [-0.1303, -0.1303],
         [-0.0856, -0.0856],
         ...,
         [ 0.0099,  0.0099],
         [ 0.0009,  0.0009],
         [-0.0106, -0.0106]],

        [[ 0.0121,  0.0121],
         [ 0.0294,  0.0294],
         [ 0.0425,  0.0425],
         ...,
         [-0.2835, -0.2835],
         [-0.2653, -0.2653],
         [-0.2545, -0.2545]],

        [[ 0.0845,  0.0845],
         [ 0.0301,  0.0301],
         [-0.0613, -0.0613],
         ...,
         [ 0.0816,  0.0816],
         [ 0.0797,  0.0797],
         [ 0.0757,  0.0757]],

        [[ 0.0306,  0.0306],
         [ 0.0240,  0.0240],
         [ 0.0129,  0.0129],
         ...,
         [-0.1293, -0.1293],
         [-0.0898, -0.0898],
         [-0.0324, -0.0324]],

        [[ 0.0087,  0.0087],
         [ 0.0090,  0.0090],
         [ 0.0092,  0.0092],
         ...,
         [-0.0086, -0.0086],
         [-0.0098, -0.0098],
         [-0.0201, -0.0201]]])
Y istensor([[[ 2.6855e-03,  2.6855e-03],
         [ 2.5940e-03,  2.5940e-03],
         [ 2.5940e-03,  2.5940e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-8.7280e-03, -8.7280e-03],
         [-9.6436e-03, -9.6436e-03],
         [-1.0529e-02, -1.0529e-02],
         ...,
         [ 9.4604e-04,  9.4604e-04],
         [-1.2207e-04, -1.2207e-04],
         [-1.2512e-03, -1.2512e-03]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-2.5330e-03, -2.5330e-03],
         [-3.1128e-03, -3.1128e-03],
         [-3.6621e-03, -3.6621e-03]],

        [[ 1.4618e-02,  1.4618e-02],
         [ 2.1210e-02,  2.1210e-02],
         [ 2.6550e-02,  2.6550e-02],
         ...,
         [-6.1646e-03, -6.1646e-03],
         [ 1.3184e-02,  1.3184e-02],
         [ 3.3905e-02,  3.3905e-02]],

        [[ 4.8798e-02,  4.8798e-02],
         [ 4.0314e-02,  4.0314e-02],
         [ 3.2196e-02,  3.2196e-02],
         ...,
         [ 1.6724e-02,  1.6724e-02],
         [-6.2866e-03, -6.2866e-03],
         [-1.7151e-02, -1.7151e-02]],

        [[ 5.3741e-02,  5.3741e-02],
         [ 3.5522e-02,  3.5522e-02],
         [ 1.4709e-02,  1.4709e-02],
         ...,
         [ 3.2349e-02,  3.2349e-02],
         [ 3.2959e-02,  3.2959e-02],
         [ 3.3386e-02,  3.3386e-02]]])
2/? [00:02<00:00,  1.31s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0643,  0.0643],
         [ 0.0495,  0.0495],
         [ 0.0361,  0.0361],
         ...,
         [-0.0351, -0.0351],
         [-0.0247, -0.0247],
         [-0.0305, -0.0305]],

        [[ 0.1613,  0.1613],
         [ 0.2000,  0.2000],
         [ 0.2326,  0.2326],
         ...,
         [ 0.0017,  0.0017],
         [ 0.0055,  0.0055],
         [ 0.0102,  0.0102]],

        [[ 0.1628,  0.1628],
         [ 0.2002,  0.2002],
         [ 0.2161,  0.2161],
         ...,
         [-0.1282, -0.1282],
         [-0.0739, -0.0739],
         [-0.0157, -0.0157]],

        [[-0.0573, -0.0573],
         [-0.0528, -0.0528],
         [-0.0464, -0.0464],
         ...,
         [ 0.1517,  0.1517],
         [ 0.1438,  0.1438],
         [ 0.1322,  0.1322]],

        [[ 0.1364,  0.1364],
         [ 0.0826,  0.0826],
         [ 0.0471,  0.0471],
         ...,
         [ 0.0038,  0.0038],
         [-0.0084, -0.0084],
         [-0.0214, -0.0214]],

        [[ 0.0440,  0.0440],
         [ 0.0336,  0.0336],
         [ 0.0188,  0.0188],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]]])
Y istensor([[[ 2.5177e-02,  2.5177e-02],
         [ 2.6306e-02,  2.6306e-02],
         [ 2.8259e-02,  2.8259e-02],
         ...,
         [-2.6276e-02, -2.6276e-02],
         [-3.3722e-02, -3.3722e-02],
         [-3.8788e-02, -3.8788e-02]],

        [[ 3.0518e-05,  3.0518e-05],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.1035e-05,  6.1035e-05],
         ...,
         [-3.5736e-02, -3.5736e-02],
         [-3.6346e-02, -3.6346e-02],
         [-3.6438e-02, -3.6438e-02]],

        [[-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [ 7.9346e-04,  7.9346e-04],
         [ 7.3242e-04,  7.3242e-04],
         [ 8.5449e-04,  8.5449e-04]],

        [[-8.1177e-03, -8.1177e-03],
         [-7.3853e-03, -7.3853e-03],
         [-7.9651e-03, -7.9651e-03],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-3.8971e-02, -3.8971e-02],
         [-3.9490e-02, -3.9490e-02],
         [-3.8940e-02, -3.8940e-02]],

        [[-2.0477e-02, -2.0477e-02],
         [-1.7548e-02, -1.7548e-02],
         [-1.2451e-02, -1.2451e-02],
         ...,
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05]]])
3/? [00:03<00:00,  1.20s/it]3/? [00:03<00:00,  1.14s/it]
Train recons_loss_l1: 0.5452 spectral_loss_l1: 0.7553 multispectral_loss_l1: 0.4850 recons_loss: 0.5452 spectral_loss: 0.7553 multispectral_loss: 0.4850 spectral_convergence: 7.1838 l2_loss: 0.4499 l1_loss: 0.7702 linf_loss: 4.7604 commit_loss: 0.0009 fit: 0.0579 pn: 0.1878 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0001 loss: 1.0302 gn: 28.1784 lr: 0.0000 lg_loss_scale: 0.0000 epoch: 2.0000
Epoch:  3 / 350
tensor([[[-3.6621e-04, -3.6621e-04],
         [ 4.8828e-04,  4.8828e-04],
         [ 1.2207e-03,  1.2207e-03],
         ...,
         [ 2.2247e-02,  2.2247e-02],
         [ 1.6907e-02,  1.6907e-02],
         [ 1.1566e-02,  1.1566e-02]],

        [[ 3.9978e-03,  3.9978e-03],
         [ 4.5471e-03,  4.5471e-03],
         [ 3.2349e-03,  3.2349e-03],
         ...,
         [-1.0748e-01, -1.0748e-01],
         [-9.6832e-02, -9.6832e-02],
         [-7.7576e-02, -7.7576e-02]],

        [[-5.8563e-02, -5.8563e-02],
         [-4.3701e-02, -4.3701e-02],
         [-2.5116e-02, -2.5116e-02],
         ...,
         [ 7.2601e-02,  7.2601e-02],
         [ 4.4281e-02,  4.4281e-02],
         [ 1.6022e-02,  1.6022e-02]],

        [[ 1.1362e-01,  1.1362e-01],
         [ 1.2662e-01,  1.2662e-01],
         [ 1.2830e-01,  1.2830e-01],
         ...,
         [ 5.0049e-03,  5.0049e-03],
         [ 2.6855e-03,  2.6855e-03],
         [ 1.0071e-03,  1.0071e-03]],

        [[-2.2858e-02, -2.2858e-02],
         [-6.6833e-03, -6.6833e-03],
         [ 1.3458e-02,  1.3458e-02],
         ...,
         [ 1.5564e-03,  1.5564e-03],
         [-6.1035e-05, -6.1035e-05],
         [-8.8501e-04, -8.8501e-04]],

        [[ 8.2397e-03,  8.2397e-03],
         [ 9.8572e-03,  9.8572e-03],
         [ 1.2817e-02,  1.2817e-02],
         ...,
         [-2.1362e-04, -2.1362e-04],
         [-2.4414e-04, -2.4414e-04],
         [-2.4414e-04, -2.4414e-04]]])
tensor([[[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-8.1177e-03, -8.1177e-03],
         [-2.1942e-02, -2.1942e-02],
         [-3.3966e-02, -3.3966e-02]],

        [[ 2.6550e-02,  2.6550e-02],
         [ 2.4933e-02,  2.4933e-02],
         [ 2.3926e-02,  2.3926e-02],
         ...,
         [-4.2511e-02, -4.2511e-02],
         [-4.6814e-02, -4.6814e-02],
         [-5.8807e-02, -5.8807e-02]],

        [[-1.8768e-02, -1.8768e-02],
         [-1.1200e-02, -1.1200e-02],
         [ 7.0801e-03,  7.0801e-03],
         ...,
         [ 6.1035e-05,  6.1035e-05],
         [ 6.1035e-05,  6.1035e-05],
         [ 6.1035e-05,  6.1035e-05]],

        [[ 1.5900e-02,  1.5900e-02],
         [-2.3193e-03, -2.3193e-03],
         [-1.9531e-02, -1.9531e-02],
         ...,
         [-1.1292e-03, -1.1292e-03],
         [-1.1292e-03, -1.1292e-03],
         [-1.1292e-03, -1.1292e-03]],

        [[ 6.1035e-04,  6.1035e-04],
         [ 9.0637e-03,  9.0637e-03],
         [ 2.1149e-02,  2.1149e-02],
         ...,
         [ 3.6011e-03,  3.6011e-03],
         [ 2.8992e-03,  2.8992e-03],
         [ 2.5635e-03,  2.5635e-03]],

        [[ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0480,  0.0480],
         [ 0.0467,  0.0467],
         [ 0.0563,  0.0563],
         ...,
         [-0.0002, -0.0002],
         [-0.0186, -0.0186],
         [-0.0339, -0.0339]],

        [[-0.0175, -0.0175],
         [-0.0864, -0.0864],
         [-0.1506, -0.1506],
         ...,
         [-0.0337, -0.0337],
         [-0.0372, -0.0372],
         [-0.0406, -0.0406]],

        [[ 0.0166,  0.0166],
         [ 0.0213,  0.0213],
         [ 0.0260,  0.0260],
         ...,
         [ 0.0005,  0.0005],
         [ 0.0007,  0.0007],
         [ 0.0008,  0.0008]],

        [[ 0.0623,  0.0623],
         [ 0.0370,  0.0370],
         [ 0.0094,  0.0094],
         ...,
         [-0.0380, -0.0380],
         [ 0.0678,  0.0678],
         [ 0.1623,  0.1623]],

        [[ 0.0859,  0.0859],
         [ 0.0421,  0.0421],
         [-0.0029, -0.0029],
         ...,
         [ 0.0451,  0.0451],
         [ 0.0198,  0.0198],
         [-0.0093, -0.0093]],

        [[-0.1295, -0.1295],
         [-0.1250, -0.1250],
         [-0.1303, -0.1303],
         ...,
         [ 0.0811,  0.0811],
         [ 0.0854,  0.0854],
         [ 0.0875,  0.0875]]])
Y istensor([[[-3.7354e-02, -3.7354e-02],
         [-3.6926e-02, -3.6926e-02],
         [-3.6102e-02, -3.6102e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 1.0345e-02,  1.0345e-02],
         [ 1.0681e-02,  1.0681e-02],
         [ 1.1108e-02,  1.1108e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 3.0518e-05,  3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[ 1.2207e-04,  1.2207e-04],
         [ 1.2207e-04,  1.2207e-04],
         [ 9.1553e-05,  9.1553e-05],
         ...,
         [ 2.5146e-02,  2.5146e-02],
         [ 1.2817e-02,  1.2817e-02],
         [ 4.5776e-04,  4.5776e-04]],

        [[ 2.7161e-02,  2.7161e-02],
         [ 2.9022e-02,  2.9022e-02],
         [ 3.0029e-02,  3.0029e-02],
         ...,
         [ 8.9203e-02,  8.9203e-02],
         [ 7.8644e-02,  7.8644e-02],
         [ 6.6254e-02,  6.6254e-02]],

        [[ 5.3406e-03,  5.3406e-03],
         [ 8.5144e-03,  8.5144e-03],
         [ 1.2146e-02,  1.2146e-02],
         ...,
         [ 1.9958e-02,  1.9958e-02],
         [ 1.5442e-02,  1.5442e-02],
         [ 1.6937e-02,  1.6937e-02]],

        [[ 3.4851e-02,  3.4851e-02],
         [ 3.6011e-02,  3.6011e-02],
         [ 3.6743e-02,  3.6743e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00]]])
1/? [00:02<00:00,  2.05s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 2.5085e-02,  2.5085e-02],
         [ 3.0151e-02,  3.0151e-02],
         [ 3.3142e-02,  3.3142e-02],
         ...,
         [ 3.2947e-01,  3.2947e-01],
         [ 3.2681e-01,  3.2681e-01],
         [ 2.9422e-01,  2.9422e-01]],

        [[-9.3475e-02, -9.3475e-02],
         [-9.6558e-02, -9.6558e-02],
         [-1.0138e-01, -1.0138e-01],
         ...,
         [ 1.8158e-02,  1.8158e-02],
         [ 1.3306e-02,  1.3306e-02],
         [ 7.9041e-03,  7.9041e-03]],

        [[-8.3618e-03, -8.3618e-03],
         [ 8.1787e-03,  8.1787e-03],
         [-2.3804e-03, -2.3804e-03],
         ...,
         [ 2.7466e-04,  2.7466e-04],
         [ 1.0681e-03,  1.0681e-03],
         [ 1.0681e-03,  1.0681e-03]],

        [[ 3.0457e-02,  3.0457e-02],
         [-3.0579e-02, -3.0579e-02],
         [-4.5349e-02, -4.5349e-02],
         ...,
         [-1.8005e-02, -1.8005e-02],
         [-1.1292e-02, -1.1292e-02],
         [-4.9438e-03, -4.9438e-03]],

        [[-3.0276e-01, -3.0276e-01],
         [-3.3447e-01, -3.3447e-01],
         [-3.7036e-01, -3.7036e-01],
         ...,
         [ 1.0443e-01,  1.0443e-01],
         [ 9.9915e-02,  9.9915e-02],
         [ 9.3597e-02,  9.3597e-02]],

        [[ 9.9670e-02,  9.9670e-02],
         [ 6.9885e-02,  6.9885e-02],
         [ 4.2786e-02,  4.2786e-02],
         ...,
         [-1.2622e-01, -1.2622e-01],
         [-1.4478e-01, -1.4478e-01],
         [-1.5698e-01, -1.5698e-01]]])
Y istensor([[[-1.1078e-02, -1.1078e-02],
         [-1.1719e-02, -1.1719e-02],
         [-1.1932e-02, -1.1932e-02],
         ...,
         [-5.3162e-02, -5.3162e-02],
         [-5.1453e-02, -5.1453e-02],
         [-4.9530e-02, -4.9530e-02]],

        [[ 4.5715e-02,  4.5715e-02],
         [ 5.4138e-02,  5.4138e-02],
         [ 5.8685e-02,  5.8685e-02],
         ...,
         [ 6.8970e-03,  6.8970e-03],
         [ 1.4587e-02,  1.4587e-02],
         [ 1.8707e-02,  1.8707e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 2.0142e-03,  2.0142e-03],
         [ 5.2185e-03,  5.2185e-03],
         [ 6.6528e-03,  6.6528e-03]],

        [[-6.9275e-03, -6.9275e-03],
         [-1.1902e-03, -1.1902e-03],
         [ 7.1716e-03,  7.1716e-03],
         ...,
         [ 2.7466e-03,  2.7466e-03],
         [ 7.3242e-04,  7.3242e-04],
         [-2.9602e-03, -2.9602e-03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [ 5.1697e-02,  5.1697e-02],
         [ 5.1788e-02,  5.1788e-02],
         [ 4.9774e-02,  4.9774e-02]],

        [[ 2.3193e-03,  2.3193e-03],
         [-9.7656e-04, -9.7656e-04],
         [-3.9978e-03, -3.9978e-03],
         ...,
         [-1.1322e-02, -1.1322e-02],
         [-1.1444e-02, -1.1444e-02],
         [-1.1017e-02, -1.1017e-02]]])
2/? [00:02<00:00,  1.72s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.2416,  0.2416],
         [ 0.2710,  0.2710],
         [ 0.2863,  0.2863],
         ...,
         [ 0.0484,  0.0484],
         [ 0.0334,  0.0334],
         [ 0.0372,  0.0372]],

        [[ 0.0089,  0.0089],
         [ 0.0168,  0.0168],
         [ 0.0243,  0.0243],
         ...,
         [ 0.0734,  0.0734],
         [ 0.1154,  0.1154],
         [ 0.1585,  0.1585]],

        [[ 0.0276,  0.0276],
         [ 0.0269,  0.0269],
         [ 0.0242,  0.0242],
         ...,
         [ 0.0254,  0.0254],
         [ 0.0223,  0.0223],
         [ 0.0221,  0.0221]],

        [[-0.0961, -0.0961],
         [-0.0931, -0.0931],
         [-0.0941, -0.0941],
         ...,
         [ 0.1127,  0.1127],
         [ 0.0789,  0.0789],
         [ 0.0345,  0.0345]],

        [[ 0.0504,  0.0504],
         [ 0.0337,  0.0337],
         [ 0.0214,  0.0214],
         ...,
         [-0.0033, -0.0033],
         [-0.0042, -0.0042],
         [-0.0034, -0.0034]],

        [[-0.0161, -0.0161],
         [-0.0157, -0.0157],
         [-0.0157, -0.0157],
         ...,
         [ 0.0636,  0.0636],
         [ 0.0875,  0.0875],
         [ 0.1086,  0.1086]]])
Y istensor([[[ 4.7302e-03,  4.7302e-03],
         [ 4.6082e-03,  4.6082e-03],
         [ 5.0354e-03,  5.0354e-03],
         ...,
         [-4.0894e-02, -4.0894e-02],
         [-3.0212e-02, -3.0212e-02],
         [-1.7395e-02, -1.7395e-02]],

        [[-2.3804e-02, -2.3804e-02],
         [-6.0730e-03, -6.0730e-03],
         [ 1.3702e-02,  1.3702e-02],
         ...,
         [ 2.1881e-02,  2.1881e-02],
         [ 1.8921e-02,  1.8921e-02],
         [ 1.6174e-02,  1.6174e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-4.8340e-02, -4.8340e-02],
         [-2.3529e-02, -2.3529e-02],
         [-2.2583e-03, -2.2583e-03]],

        [[-1.1078e-02, -1.1078e-02],
         [-1.1658e-02, -1.1658e-02],
         [-1.2299e-02, -1.2299e-02],
         ...,
         [ 2.1362e-04,  2.1362e-04],
         [ 1.2207e-04,  1.2207e-04],
         [ 3.0518e-05,  3.0518e-05]],

        [[-4.9347e-02, -4.9347e-02],
         [-4.2755e-02, -4.2755e-02],
         [-3.4058e-02, -3.4058e-02],
         ...,
         [ 6.1035e-04,  6.1035e-04],
         [ 7.0190e-04,  7.0190e-04],
         [ 3.3569e-04,  3.3569e-04]],

        [[-3.1738e-02, -3.1738e-02],
         [-2.9419e-02, -2.9419e-02],
         [-2.7557e-02, -2.7557e-02],
         ...,
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05]]])
3/? [00:03<00:00,  1.49s/it]3/? [00:04<00:00,  1.34s/it]
Train recons_loss_l1: 0.3883 spectral_loss_l1: 0.5777 multispectral_loss_l1: 0.3742 recons_loss: 0.3883 spectral_loss: 0.5777 multispectral_loss: 0.3742 spectral_convergence: 1.9537 l2_loss: 0.2972 l1_loss: 0.5916 linf_loss: 4.5545 commit_loss: 0.0019 fit: 0.1234 pn: 0.1924 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0001 loss: 0.7626 gn: 20.0785 lr: 0.0000 lg_loss_scale: 0.0000 epoch: 3.0000
Epoch:  4 / 350
tensor([[[ 0.1724,  0.1724],
         [ 0.1876,  0.1876],
         [ 0.1754,  0.1754],
         ...,
         [ 0.0310,  0.0310],
         [ 0.0707,  0.0707],
         [ 0.1071,  0.1071]],

        [[-0.0075, -0.0075],
         [-0.0089, -0.0089],
         [ 0.0031,  0.0031],
         ...,
         [ 0.0265,  0.0265],
         [ 0.0485,  0.0485],
         [ 0.0714,  0.0714]],

        [[-0.1551, -0.1551],
         [-0.1492, -0.1492],
         [-0.1502, -0.1502],
         ...,
         [ 0.0062,  0.0062],
         [ 0.0061,  0.0061],
         [ 0.0124,  0.0124]],

        [[ 0.0519,  0.0519],
         [ 0.0466,  0.0466],
         [ 0.0503,  0.0503],
         ...,
         [ 0.0341,  0.0341],
         [ 0.0246,  0.0246],
         [ 0.0121,  0.0121]],

        [[-0.0061, -0.0061],
         [-0.0278, -0.0278],
         [-0.0485, -0.0485],
         ...,
         [ 0.0954,  0.0954],
         [ 0.1073,  0.1073],
         [ 0.1128,  0.1128]],

        [[-0.0224, -0.0224],
         [ 0.0074,  0.0074],
         [ 0.0331,  0.0331],
         ...,
         [-0.0128, -0.0128],
         [-0.0072, -0.0072],
         [ 0.0093,  0.0093]]])
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [ 5.7068e-03,  5.7068e-03],
         [ 5.6152e-03,  5.6152e-03],
         [ 5.5542e-03,  5.5542e-03]],

        [[-6.2469e-02, -6.2469e-02],
         [-6.6742e-02, -6.6742e-02],
         [-7.1320e-02, -7.1320e-02],
         ...,
         [-6.8054e-03, -6.8054e-03],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.5542e-03,  5.5542e-03]],

        [[ 3.4424e-02,  3.4424e-02],
         [ 2.7954e-02,  2.7954e-02],
         [ 3.9368e-03,  3.9368e-03],
         ...,
         [-1.2650e-01, -1.2650e-01],
         [-1.4545e-01, -1.4545e-01],
         [-1.5918e-01, -1.5918e-01]],

        [[ 1.6205e-02,  1.6205e-02],
         [ 1.7578e-02,  1.7578e-02],
         [ 1.8860e-02,  1.8860e-02],
         ...,
         [-1.9287e-02, -1.9287e-02],
         [-1.9409e-02, -1.9409e-02],
         [-1.9501e-02, -1.9501e-02]],

        [[-7.8979e-02, -7.8979e-02],
         [-6.0455e-02, -6.0455e-02],
         [-4.4342e-02, -4.4342e-02],
         ...,
         [ 1.1746e-01,  1.1746e-01],
         [ 1.2405e-01,  1.2405e-01],
         [ 1.1636e-01,  1.1636e-01]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-2.8473e-02, -2.8473e-02],
         [ 2.7466e-04,  2.7466e-04],
         [-3.1433e-03, -3.1433e-03],
         ...,
         [ 2.5388e-01,  2.5388e-01],
         [ 2.0596e-01,  2.0596e-01],
         [ 1.4236e-01,  1.4236e-01]],

        [[ 6.3477e-02,  6.3477e-02],
         [ 6.1737e-02,  6.1737e-02],
         [ 5.5267e-02,  5.5267e-02],
         ...,
         [-1.1450e-01, -1.1450e-01],
         [-1.1465e-01, -1.1465e-01],
         [-1.1337e-01, -1.1337e-01]],

        [[-5.9814e-03, -5.9814e-03],
         [ 9.5215e-03,  9.5215e-03],
         [ 2.5818e-02,  2.5818e-02],
         ...,
         [ 2.0355e-02,  2.0355e-02],
         [ 4.6936e-02,  4.6936e-02],
         [ 6.9000e-02,  6.9000e-02]],

        [[-2.2736e-02, -2.2736e-02],
         [-2.2858e-02, -2.2858e-02],
         [-2.3102e-02, -2.3102e-02],
         ...,
         [-5.0140e-02, -5.0140e-02],
         [-4.8523e-02, -4.8523e-02],
         [-4.2419e-02, -4.2419e-02]],

        [[ 1.6714e-01,  1.6714e-01],
         [ 1.2195e-01,  1.2195e-01],
         [ 9.6405e-02,  9.6405e-02],
         ...,
         [ 1.7883e-02,  1.7883e-02],
         [ 1.5289e-02,  1.5289e-02],
         [ 1.2115e-02,  1.2115e-02]],

        [[ 6.7230e-02,  6.7230e-02],
         [ 4.4891e-02,  4.4891e-02],
         [ 3.0579e-02,  3.0579e-02],
         ...,
         [ 2.7628e-01,  2.7628e-01],
         [ 2.8067e-01,  2.8067e-01],
         [ 2.7930e-01,  2.7930e-01]]])
Y istensor([[[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 3.6011e-02,  3.6011e-02],
         [ 3.5065e-02,  3.5065e-02],
         [ 3.1738e-02,  3.1738e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-2.1362e-02, -2.1362e-02],
         [-1.2451e-02, -1.2451e-02],
         [-4.6082e-03, -4.6082e-03]],

        [[-3.3813e-02, -3.3813e-02],
         [-3.4485e-02, -3.4485e-02],
         [-3.4576e-02, -3.4576e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[ 3.9764e-02,  3.9764e-02],
         [ 4.5044e-02,  4.5044e-02],
         [ 5.6824e-02,  5.6824e-02],
         ...,
         [-1.2543e-02, -1.2543e-02],
         [-1.3092e-02, -1.3092e-02],
         [-1.2634e-02, -1.2634e-02]],

        [[-6.3354e-02, -6.3354e-02],
         [-7.1320e-02, -7.1320e-02],
         [-7.9803e-02, -7.9803e-02],
         ...,
         [ 5.8655e-02,  5.8655e-02],
         [ 6.3477e-02,  6.3477e-02],
         [ 6.5186e-02,  6.5186e-02]],

        [[-2.0142e-03, -2.0142e-03],
         [-2.4109e-03, -2.4109e-03],
         [-2.8076e-03, -2.8076e-03],
         ...,
         [ 2.1362e-04,  2.1362e-04],
         [ 2.1362e-04,  2.1362e-04],
         [ 2.4414e-04,  2.4414e-04]]])
1/? [00:01<00:00,  1.58s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 3.3569e-03,  3.3569e-03],
         [ 4.7913e-03,  4.7913e-03],
         [ 4.5471e-03,  4.5471e-03],
         ...,
         [-2.1057e-02, -2.1057e-02],
         [-3.3173e-02, -3.3173e-02],
         [-4.4189e-02, -4.4189e-02]],

        [[-2.4536e-02, -2.4536e-02],
         [-1.9775e-02, -1.9775e-02],
         [-1.8158e-02, -1.8158e-02],
         ...,
         [ 2.2339e-02,  2.2339e-02],
         [ 1.8768e-02,  1.8768e-02],
         [ 1.4832e-02,  1.4832e-02]],

        [[ 2.4414e-03,  2.4414e-03],
         [ 2.5024e-03,  2.5024e-03],
         [ 2.5024e-03,  2.5024e-03],
         ...,
         [-9.0118e-02, -9.0118e-02],
         [-9.0393e-02, -9.0393e-02],
         [-9.0179e-02, -9.0179e-02]],

        [[ 4.6744e-01,  4.6744e-01],
         [ 4.2468e-01,  4.2468e-01],
         [ 3.9178e-01,  3.9178e-01],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [ 9.1553e-05,  9.1553e-05]],

        [[ 9.2865e-02,  9.2865e-02],
         [ 8.8776e-02,  8.8776e-02],
         [ 8.5876e-02,  8.5876e-02],
         ...,
         [-7.6233e-02, -7.6233e-02],
         [-5.5511e-02, -5.5511e-02],
         [-3.0121e-02, -3.0121e-02]],

        [[-7.3853e-02, -7.3853e-02],
         [-1.0599e-01, -1.0599e-01],
         [-1.3870e-01, -1.3870e-01],
         ...,
         [ 1.8274e-01,  1.8274e-01],
         [ 1.5817e-01,  1.5817e-01],
         [ 1.3306e-01,  1.3306e-01]]])
Y istensor([[[-3.0182e-02, -3.0182e-02],
         [-3.2959e-02, -3.2959e-02],
         [-3.6133e-02, -3.6133e-02],
         ...,
         [-1.0376e-03, -1.0376e-03],
         [-1.0376e-03, -1.0376e-03],
         [-1.0376e-03, -1.0376e-03]],

        [[ 2.8809e-02,  2.8809e-02],
         [ 2.8259e-02,  2.8259e-02],
         [ 2.8259e-02,  2.8259e-02],
         ...,
         [-5.5298e-02, -5.5298e-02],
         [-5.5634e-02, -5.5634e-02],
         [-5.5481e-02, -5.5481e-02]],

        [[ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         ...,
         [-6.5308e-03, -6.5308e-03],
         [-3.2104e-02, -3.2104e-02],
         [-4.5044e-02, -4.5044e-02]],

        [[ 2.0752e-02,  2.0752e-02],
         [ 2.0935e-02,  2.0935e-02],
         [ 2.1240e-02,  2.1240e-02],
         ...,
         [ 1.8723e-01,  1.8723e-01],
         [ 1.9470e-01,  1.9470e-01],
         [ 1.8591e-01,  1.8591e-01]],

        [[ 4.3579e-02,  4.3579e-02],
         [ 5.1025e-02,  5.1025e-02],
         [ 5.7129e-02,  5.7129e-02],
         ...,
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 2.1240e-02,  2.1240e-02],
         [ 2.4841e-02,  2.4841e-02],
         [ 2.8503e-02,  2.8503e-02]]])
2/? [00:02<00:00,  1.39s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.0073, -0.0073],
         [ 0.0032,  0.0032],
         [ 0.0105,  0.0105],
         ...,
         [ 0.0189,  0.0189],
         [ 0.0329,  0.0329],
         [ 0.0102,  0.0102]],

        [[ 0.0193,  0.0193],
         [ 0.0351,  0.0351],
         [ 0.0493,  0.0493],
         ...,
         [ 0.0869,  0.0869],
         [ 0.0892,  0.0892],
         [ 0.0926,  0.0926]],

        [[ 0.0174,  0.0174],
         [ 0.0183,  0.0183],
         [ 0.0200,  0.0200],
         ...,
         [ 0.0197,  0.0197],
         [ 0.0270,  0.0270],
         [ 0.0342,  0.0342]],

        [[-0.0305, -0.0305],
         [-0.0136, -0.0136],
         [ 0.0131,  0.0131],
         ...,
         [ 0.0156,  0.0156],
         [ 0.0142,  0.0142],
         [ 0.0128,  0.0128]],

        [[ 0.0002,  0.0002],
         [-0.0113, -0.0113],
         [-0.0035, -0.0035],
         ...,
         [-0.0255, -0.0255],
         [-0.0286, -0.0286],
         [-0.0343, -0.0343]],

        [[-0.1374, -0.1374],
         [-0.1035, -0.1035],
         [-0.0669, -0.0669],
         ...,
         [ 0.0262,  0.0262],
         [ 0.0085,  0.0085],
         [-0.0040, -0.0040]]])
Y istensor([[[-4.2419e-02, -4.2419e-02],
         [-3.3417e-02, -3.3417e-02],
         [-2.1912e-02, -2.1912e-02],
         ...,
         [ 2.6031e-02,  2.6031e-02],
         [ 3.3966e-02,  3.3966e-02],
         [ 3.9368e-02,  3.9368e-02]],

        [[ 4.2725e-04,  4.2725e-04],
         [ 4.8828e-04,  4.8828e-04],
         [ 5.4932e-04,  5.4932e-04],
         ...,
         [ 8.7738e-02,  8.7738e-02],
         [ 1.0953e-01,  1.0953e-01],
         [ 1.2051e-01,  1.2051e-01]],

        [[-2.8992e-02, -2.8992e-02],
         [-3.1067e-02, -3.1067e-02],
         [-2.9846e-02, -2.9846e-02],
         ...,
         [ 1.2024e-02,  1.2024e-02],
         [ 4.6997e-03,  4.6997e-03],
         [-3.1433e-03, -3.1433e-03]],

        [[-4.3762e-02, -4.3762e-02],
         [-5.9235e-02, -5.9235e-02],
         [-6.5704e-02, -6.5704e-02],
         ...,
         [-8.9722e-03, -8.9722e-03],
         [-2.8381e-03, -2.8381e-03],
         [-1.8311e-04, -1.8311e-04]],

        [[-6.1035e-05, -6.1035e-05],
         [ 2.4414e-04,  2.4414e-04],
         [ 3.9673e-04,  3.9673e-04],
         ...,
         [-3.7720e-02, -3.7720e-02],
         [-2.4536e-02, -2.4536e-02],
         [-1.0010e-02, -1.0010e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 1.5652e-01,  1.5652e-01],
         [ 1.5112e-01,  1.5112e-01],
         [ 1.3690e-01,  1.3690e-01]]])
3/? [00:03<00:00,  1.26s/it]3/? [00:03<00:00,  1.18s/it]
Train recons_loss_l1: 0.2158 spectral_loss_l1: 0.3900 multispectral_loss_l1: 0.2579 recons_loss: 0.2158 spectral_loss: 0.3900 multispectral_loss: 0.2579 spectral_convergence: 1.2702 l2_loss: 0.1537 l1_loss: 0.3908 linf_loss: 3.1050 commit_loss: 0.0038 fit: 0.2409 pn: 0.2040 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0001 loss: 0.4737 gn: 7.5490 lr: 0.0000 lg_loss_scale: 0.0000 epoch: 4.0000
Epoch:  5 / 350
tensor([[[ 9.1553e-05,  9.1553e-05],
         [ 1.5259e-04,  1.5259e-04],
         [ 1.5259e-04,  1.5259e-04],
         ...,
         [-1.1322e-02, -1.1322e-02],
         [-9.4910e-03, -9.4910e-03],
         [-6.1340e-03, -6.1340e-03]],

        [[ 8.5449e-04,  8.5449e-04],
         [ 2.7191e-02,  2.7191e-02],
         [ 5.6641e-02,  5.6641e-02],
         ...,
         [-2.0331e-01, -2.0331e-01],
         [-2.0792e-01, -2.0792e-01],
         [-2.0190e-01, -2.0190e-01]],

        [[ 4.4586e-02,  4.4586e-02],
         [ 3.5797e-02,  3.5797e-02],
         [ 1.4954e-02,  1.4954e-02],
         ...,
         [-1.1292e-03, -1.1292e-03],
         [ 7.2632e-03,  7.2632e-03],
         [ 1.5320e-02,  1.5320e-02]],

        [[-2.1155e-01, -2.1155e-01],
         [-2.1500e-01, -2.1500e-01],
         [-2.2293e-01, -2.2293e-01],
         ...,
         [-4.3671e-02, -4.3671e-02],
         [-1.8768e-02, -1.8768e-02],
         [ 1.1597e-03,  1.1597e-03]],

        [[-1.6113e-02, -1.6113e-02],
         [-7.6904e-03, -7.6904e-03],
         [ 1.1292e-03,  1.1292e-03],
         ...,
         [ 1.1414e-02,  1.1414e-02],
         [-1.7090e-03, -1.7090e-03],
         [-1.9501e-02, -1.9501e-02]],

        [[-6.6833e-03, -6.6833e-03],
         [ 3.9673e-04,  3.9673e-04],
         [ 8.9722e-03,  8.9722e-03],
         ...,
         [ 1.6724e-02,  1.6724e-02],
         [ 1.0345e-02,  1.0345e-02],
         [-2.0630e-02, -2.0630e-02]]])
tensor([[[ 4.1199e-03,  4.1199e-03],
         [ 4.1504e-03,  4.1504e-03],
         [ 4.1199e-03,  4.1199e-03],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 6.3049e-02,  6.3049e-02],
         [ 5.2765e-02,  5.2765e-02],
         [ 3.9246e-02,  3.9246e-02]],

        [[-5.3406e-03, -5.3406e-03],
         [-3.1738e-02, -3.1738e-02],
         [-7.0312e-02, -7.0312e-02],
         ...,
         [ 8.4106e-02,  8.4106e-02],
         [ 9.0332e-02,  9.0332e-02],
         [ 9.3292e-02,  9.3292e-02]],

        [[-2.0538e-02, -2.0538e-02],
         [-1.8738e-02, -1.8738e-02],
         [-1.3824e-02, -1.3824e-02],
         ...,
         [-2.2064e-02, -2.2064e-02],
         [-2.0142e-02, -2.0142e-02],
         [-1.7944e-02, -1.7944e-02]],

        [[-1.2787e-02, -1.2787e-02],
         [-1.3550e-02, -1.3550e-02],
         [-1.0956e-02, -1.0956e-02],
         ...,
         [-4.8828e-04, -4.8828e-04],
         [-5.7983e-04, -5.7983e-04],
         [-5.4932e-04, -5.4932e-04]],

        [[-4.5502e-02, -4.5502e-02],
         [-2.8076e-02, -2.8076e-02],
         [-1.1414e-02, -1.1414e-02],
         ...,
         [-4.8828e-04, -4.8828e-04],
         [-2.2278e-03, -2.2278e-03],
         [-8.3313e-03, -8.3313e-03]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-4.2023e-02, -4.2023e-02],
         [-4.6387e-03, -4.6387e-03],
         [ 3.3783e-02,  3.3783e-02],
         ...,
         [-5.0781e-02, -5.0781e-02],
         [-7.0465e-02, -7.0465e-02],
         [-8.8531e-02, -8.8531e-02]],

        [[ 1.2207e-04,  1.2207e-04],
         [ 1.9501e-02,  1.9501e-02],
         [ 1.8066e-02,  1.8066e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [-1.2207e-04, -1.2207e-04],
         [-2.4414e-04, -2.4414e-04]],

        [[ 3.0212e-02,  3.0212e-02],
         [ 4.1168e-02,  4.1168e-02],
         [ 4.3610e-02,  4.3610e-02],
         ...,
         [-2.4628e-02, -2.4628e-02],
         [-1.8311e-02, -1.8311e-02],
         [-4.0283e-03, -4.0283e-03]],

        [[ 5.4718e-02,  5.4718e-02],
         [ 4.9988e-02,  4.9988e-02],
         [ 4.4128e-02,  4.4128e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 6.4697e-03,  6.4697e-03],
         [ 9.6130e-03,  9.6130e-03]],

        [[-1.6263e-01, -1.6263e-01],
         [-1.6528e-01, -1.6528e-01],
         [-1.6306e-01, -1.6306e-01],
         ...,
         [-6.0120e-03, -6.0120e-03],
         [-3.5706e-03, -3.5706e-03],
         [-3.1128e-03, -3.1128e-03]],

        [[ 8.2306e-02,  8.2306e-02],
         [ 1.0477e-01,  1.0477e-01],
         [ 1.2054e-01,  1.2054e-01],
         ...,
         [-2.8076e-02, -2.8076e-02],
         [-1.5350e-02, -1.5350e-02],
         [-5.3101e-03, -5.3101e-03]]])
Y istensor([[[-2.3376e-02, -2.3376e-02],
         [-2.4475e-02, -2.4475e-02],
         [-2.5391e-02, -2.5391e-02],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-3.7323e-02, -3.7323e-02],
         [-4.3579e-02, -4.3579e-02],
         [-5.0507e-02, -5.0507e-02]],

        [[-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [-1.3062e-02, -1.3062e-02],
         [ 2.4719e-03,  2.4719e-03],
         [ 1.9775e-02,  1.9775e-02]],

        [[ 3.9337e-02,  3.9337e-02],
         [ 3.5767e-02,  3.5767e-02],
         [ 3.3569e-02,  3.3569e-02],
         ...,
         [ 1.5015e-02,  1.5015e-02],
         [ 3.3356e-02,  3.3356e-02],
         [ 4.8279e-02,  4.8279e-02]],

        [[ 1.5472e-02,  1.5472e-02],
         [ 1.0529e-02,  1.0529e-02],
         [ 3.9062e-03,  3.9062e-03],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-1.3388e-01, -1.3388e-01],
         [-1.4066e-01, -1.4066e-01],
         [-1.3959e-01, -1.3959e-01],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]]])
1/? [00:02<00:00,  2.89s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.1114,  0.1114],
         [ 0.1322,  0.1322],
         [ 0.1466,  0.1466],
         ...,
         [ 0.1788,  0.1788],
         [ 0.1200,  0.1200],
         [ 0.0591,  0.0591]],

        [[-0.0040, -0.0040],
         [-0.0037, -0.0037],
         [-0.0031, -0.0031],
         ...,
         [ 0.0163,  0.0163],
         [ 0.0265,  0.0265],
         [ 0.0356,  0.0356]],

        [[-0.3237, -0.3237],
         [-0.2980, -0.2980],
         [-0.2560, -0.2560],
         ...,
         [-0.0471, -0.0471],
         [-0.0579, -0.0579],
         [-0.0675, -0.0675]],

        [[-0.0283, -0.0283],
         [-0.0298, -0.0298],
         [-0.0316, -0.0316],
         ...,
         [ 0.0107,  0.0107],
         [ 0.0138,  0.0138],
         [ 0.0165,  0.0165]],

        [[ 0.1057,  0.1057],
         [ 0.1440,  0.1440],
         [ 0.1618,  0.1618],
         ...,
         [ 0.0319,  0.0319],
         [ 0.0277,  0.0277],
         [ 0.0236,  0.0236]],

        [[ 0.0442,  0.0442],
         [ 0.0508,  0.0508],
         [ 0.0551,  0.0551],
         ...,
         [ 0.0179,  0.0179],
         [ 0.0013,  0.0013],
         [-0.0150, -0.0150]]])
Y istensor([[[-1.3428e-03, -1.3428e-03],
         [-1.5869e-03, -1.5869e-03],
         [-1.6479e-03, -1.6479e-03],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[ 4.8462e-02,  4.8462e-02],
         [ 3.6316e-02,  3.6316e-02],
         [ 2.5635e-02,  2.5635e-02],
         ...,
         [ 5.5908e-02,  5.5908e-02],
         [ 5.1758e-02,  5.1758e-02],
         [ 5.0446e-02,  5.0446e-02]],

        [[ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         ...,
         [-4.3854e-02, -4.3854e-02],
         [-3.6011e-02, -3.6011e-02],
         [-2.2522e-02, -2.2522e-02]],

        [[-1.8311e-04, -1.8311e-04],
         [ 9.1553e-03,  9.1553e-03],
         [ 1.8829e-02,  1.8829e-02],
         ...,
         [ 5.1880e-04,  5.1880e-04],
         [ 5.4932e-04,  5.4932e-04],
         [ 5.1880e-04,  5.1880e-04]],

        [[ 2.4963e-02,  2.4963e-02],
         [ 3.7994e-02,  3.7994e-02],
         [ 5.1697e-02,  5.1697e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-8.0933e-02, -8.0933e-02],
         [-6.4545e-02, -6.4545e-02],
         [-4.7638e-02, -4.7638e-02],
         ...,
         [-1.9928e-02, -1.9928e-02],
         [-2.0905e-02, -2.0905e-02],
         [-2.1454e-02, -2.1454e-02]]])
2/? [00:03<00:00,  2.30s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 3.0518e-04,  3.0518e-04],
         [-1.8311e-04, -1.8311e-04],
         [-3.3569e-04, -3.3569e-04],
         ...,
         [-5.2795e-03, -5.2795e-03],
         [-1.2390e-02, -1.2390e-02],
         [-1.9287e-02, -1.9287e-02]],

        [[ 3.6438e-02,  3.6438e-02],
         [ 2.2736e-02,  2.2736e-02],
         [ 2.4414e-04,  2.4414e-04],
         ...,
         [-2.4246e-01, -2.4246e-01],
         [-2.4683e-01, -2.4683e-01],
         [-2.4838e-01, -2.4838e-01]],

        [[ 1.3364e-01,  1.3364e-01],
         [ 1.1246e-01,  1.1246e-01],
         [ 8.8684e-02,  8.8684e-02],
         ...,
         [-1.2769e-01, -1.2769e-01],
         [-1.1230e-01, -1.1230e-01],
         [-7.9437e-02, -7.9437e-02]],

        [[ 1.6882e-01,  1.6882e-01],
         [ 1.6370e-01,  1.6370e-01],
         [ 1.4450e-01,  1.4450e-01],
         ...,
         [-1.5662e-01, -1.5662e-01],
         [-1.7068e-01, -1.7068e-01],
         [-1.8707e-01, -1.8707e-01]],

        [[ 5.7556e-02,  5.7556e-02],
         [ 3.8940e-02,  3.8940e-02],
         [ 2.0966e-02,  2.0966e-02],
         ...,
         [-1.0345e-01, -1.0345e-01],
         [-1.1154e-01, -1.1154e-01],
         [-1.1691e-01, -1.1691e-01]],

        [[-9.7717e-02, -9.7717e-02],
         [-1.1639e-01, -1.1639e-01],
         [-1.4050e-01, -1.4050e-01],
         ...,
         [-3.1128e-02, -3.1128e-02],
         [-2.6611e-02, -2.6611e-02],
         [-8.5754e-03, -8.5754e-03]]])
Y istensor([[[-9.3994e-03, -9.3994e-03],
         [-8.4534e-03, -8.4534e-03],
         [-7.0496e-03, -7.0496e-03],
         ...,
         [-9.0729e-02, -9.0729e-02],
         [-8.3038e-02, -8.3038e-02],
         [-6.9092e-02, -6.9092e-02]],

        [[ 4.9713e-02,  4.9713e-02],
         [ 4.9103e-02,  4.9103e-02],
         [ 4.7699e-02,  4.7699e-02],
         ...,
         [ 2.6520e-02,  2.6520e-02],
         [ 3.2532e-02,  3.2532e-02],
         [ 3.5980e-02,  3.5980e-02]],

        [[ 4.1199e-03,  4.1199e-03],
         [-8.4839e-03, -8.4839e-03],
         [-1.1475e-02, -1.1475e-02],
         ...,
         [-3.8757e-03, -3.8757e-03],
         [-1.5259e-04, -1.5259e-04],
         [ 1.4648e-03,  1.4648e-03]],

        [[ 1.5884e-01,  1.5884e-01],
         [ 1.9708e-01,  1.9708e-01],
         [ 2.3355e-01,  2.3355e-01],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 1.1548e-01,  1.1548e-01],
         [ 7.9071e-02,  7.9071e-02],
         [ 4.3640e-02,  4.3640e-02]],

        [[-2.7954e-02, -2.7954e-02],
         [-2.9999e-02, -2.9999e-02],
         [-3.2715e-02, -3.2715e-02],
         ...,
         [ 9.3292e-02,  9.3292e-02],
         [ 7.4493e-02,  7.4493e-02],
         [ 5.5695e-02,  5.5695e-02]]])
3/? [00:04<00:00,  1.89s/it]3/? [00:04<00:00,  1.61s/it]
Train recons_loss_l1: 0.1947 spectral_loss_l1: 0.3787 multispectral_loss_l1: 0.2477 recons_loss: 0.1947 spectral_loss: 0.3787 multispectral_loss: 0.2477 spectral_convergence: 1.2208 l2_loss: 0.1426 l1_loss: 0.3718 linf_loss: 2.6029 commit_loss: 0.0065 fit: 0.4139 pn: 0.2216 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0001 loss: 0.4425 gn: 10.6160 lr: 0.0001 lg_loss_scale: 0.0000 epoch: 5.0000
Epoch:  6 / 350
tensor([[[ 0.0148,  0.0148],
         [ 0.0019,  0.0019],
         [-0.0094, -0.0094],
         ...,
         [ 0.0670,  0.0670],
         [ 0.0695,  0.0695],
         [ 0.0628,  0.0628]],

        [[ 0.0636,  0.0636],
         [ 0.0640,  0.0640],
         [ 0.0640,  0.0640],
         ...,
         [ 0.1104,  0.1104],
         [ 0.1428,  0.1428],
         [ 0.1298,  0.1298]],

        [[ 0.0060,  0.0060],
         [ 0.0067,  0.0067],
         [ 0.0067,  0.0067],
         ...,
         [ 0.0047,  0.0047],
         [ 0.0138,  0.0138],
         [ 0.0187,  0.0187]],

        [[-0.1240, -0.1240],
         [-0.1313, -0.1313],
         [-0.1347, -0.1347],
         ...,
         [ 0.0222,  0.0222],
         [-0.0173, -0.0173],
         [-0.0594, -0.0594]],

        [[ 0.0722,  0.0722],
         [ 0.1426,  0.1426],
         [ 0.1977,  0.1977],
         ...,
         [ 0.0331,  0.0331],
         [ 0.0322,  0.0322],
         [ 0.0316,  0.0316]],

        [[ 0.0649,  0.0649],
         [ 0.0652,  0.0652],
         [ 0.0675,  0.0675],
         ...,
         [ 0.0607,  0.0607],
         [ 0.0604,  0.0604],
         [ 0.0582,  0.0582]]])
tensor([[[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-7.8430e-03, -7.8430e-03],
         [-9.4910e-03, -9.4910e-03],
         [-1.1505e-02, -1.1505e-02]],

        [[ 8.8501e-04,  8.8501e-04],
         [ 7.6294e-04,  7.6294e-04],
         [ 1.8311e-04,  1.8311e-04],
         ...,
         [-6.1035e-05, -6.1035e-05],
         [-3.0518e-05, -3.0518e-05],
         [-6.1035e-05, -6.1035e-05]],

        [[-3.3417e-02, -3.3417e-02],
         [-8.7189e-02, -8.7189e-02],
         [-1.2006e-01, -1.2006e-01],
         ...,
         [-6.0242e-02, -6.0242e-02],
         [-5.8777e-02, -5.8777e-02],
         [-5.5878e-02, -5.5878e-02]],

        [[ 3.3569e-04,  3.3569e-04],
         [ 1.8311e-04,  1.8311e-04],
         [-1.5259e-04, -1.5259e-04],
         ...,
         [ 6.1035e-03,  6.1035e-03],
         [ 6.1340e-03,  6.1340e-03],
         [ 6.2561e-03,  6.2561e-03]],

        [[ 7.4158e-03,  7.4158e-03],
         [ 3.9368e-03,  3.9368e-03],
         [-5.7983e-04, -5.7983e-04],
         ...,
         [-9.1553e-04, -9.1553e-04],
         [-1.8005e-03, -1.8005e-03],
         [-2.4414e-03, -2.4414e-03]],

        [[ 3.0518e-05,  3.0518e-05],
         [ 3.9673e-04,  3.9673e-04],
         [ 5.7983e-04,  5.7983e-04],
         ...,
         [-4.6509e-02, -4.6509e-02],
         [-4.8462e-02, -4.8462e-02],
         [-4.6143e-02, -4.6143e-02]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0015,  0.0015],
         [ 0.0010,  0.0010],
         [ 0.0006,  0.0006],
         ...,
         [-0.0088, -0.0088],
         [-0.0759, -0.0759],
         [-0.1179, -0.1179]],

        [[-0.0374, -0.0374],
         [-0.0308, -0.0308],
         [-0.0219, -0.0219],
         ...,
         [-0.1992, -0.1992],
         [-0.2471, -0.2471],
         [-0.2806, -0.2806]],

        [[ 0.0866,  0.0866],
         [ 0.0455,  0.0455],
         [-0.0048, -0.0048],
         ...,
         [ 0.1526,  0.1526],
         [ 0.1563,  0.1563],
         [ 0.1397,  0.1397]],

        [[-0.1224, -0.1224],
         [-0.1402, -0.1402],
         [-0.1602, -0.1602],
         ...,
         [ 0.0446,  0.0446],
         [ 0.0475,  0.0475],
         [ 0.0491,  0.0491]],

        [[-0.1922, -0.1922],
         [-0.2330, -0.2330],
         [-0.2184, -0.2184],
         ...,
         [ 0.2136,  0.2136],
         [ 0.2037,  0.2037],
         [ 0.1937,  0.1937]],

        [[-0.0180, -0.0180],
         [-0.0249, -0.0249],
         [-0.0398, -0.0398],
         ...,
         [-0.0127, -0.0127],
         [-0.0146, -0.0146],
         [-0.0092, -0.0092]]])
Y istensor([[[ 1.8921e-03,  1.8921e-03],
         [ 9.4604e-04,  9.4604e-04],
         [ 3.3569e-04,  3.3569e-04],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         ...,
         [-1.9836e-03, -1.9836e-03],
         [-3.2043e-03, -3.2043e-03],
         [-4.3335e-03, -4.3335e-03]],

        [[-3.6346e-02, -3.6346e-02],
         [-1.1810e-02, -1.1810e-02],
         [ 1.2573e-02,  1.2573e-02],
         ...,
         [-2.1881e-02, -2.1881e-02],
         [-1.3916e-02, -1.3916e-02],
         [-1.5228e-02, -1.5228e-02]],

        [[ 4.5471e-03,  4.5471e-03],
         [ 3.3264e-03,  3.3264e-03],
         [ 2.1057e-03,  2.1057e-03],
         ...,
         [ 8.2397e-04,  8.2397e-04],
         [ 2.8534e-02,  2.8534e-02],
         [ 5.0629e-02,  5.0629e-02]],

        [[ 5.3619e-02,  5.3619e-02],
         [ 4.7791e-02,  4.7791e-02],
         [ 4.2664e-02,  4.2664e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-4.4037e-02, -4.4037e-02],
         [-3.3112e-02, -3.3112e-02],
         [-2.0905e-02, -2.0905e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]]])
1/? [00:01<00:00,  1.70s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.1060, -0.1060],
         [-0.1171, -0.1171],
         [-0.1304, -0.1304],
         ...,
         [ 0.0572,  0.0572],
         [ 0.0611,  0.0611],
         [ 0.0643,  0.0643]],

        [[ 0.0159,  0.0159],
         [ 0.0039,  0.0039],
         [-0.0115, -0.0115],
         ...,
         [-0.1082, -0.1082],
         [-0.1138, -0.1138],
         [-0.1342, -0.1342]],

        [[ 0.0006,  0.0006],
         [-0.0002, -0.0002],
         [-0.0006, -0.0006],
         ...,
         [ 0.0036,  0.0036],
         [ 0.0068,  0.0068],
         [ 0.0068,  0.0068]],

        [[ 0.0269,  0.0269],
         [ 0.0602,  0.0602],
         [ 0.0571,  0.0571],
         ...,
         [-0.0023, -0.0023],
         [ 0.0024,  0.0024],
         [ 0.0057,  0.0057]],

        [[-0.0031, -0.0031],
         [-0.0067, -0.0067],
         [-0.0069, -0.0069],
         ...,
         [-0.0027, -0.0027],
         [-0.0243, -0.0243],
         [-0.0456, -0.0456]],

        [[ 0.0605,  0.0605],
         [ 0.0593,  0.0593],
         [ 0.0569,  0.0569],
         ...,
         [-0.1108, -0.1108],
         [-0.1182, -0.1182],
         [-0.1226, -0.1226]]])
Y istensor([[[ 1.3123e-03,  1.3123e-03],
         [ 3.6621e-04,  3.6621e-04],
         [-3.6621e-04, -3.6621e-04],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-9.0332e-03, -9.0332e-03],
         [-1.0712e-02, -1.0712e-02],
         [-1.2512e-02, -1.2512e-02],
         ...,
         [ 3.1311e-02,  3.1311e-02],
         [ 3.1067e-02,  3.1067e-02],
         [ 3.0579e-02,  3.0579e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [ 5.4474e-02,  5.4474e-02],
         [ 4.4617e-02,  4.4617e-02],
         [ 3.3447e-02,  3.3447e-02]],

        [[-1.0571e-01, -1.0571e-01],
         [-9.2651e-02, -9.2651e-02],
         [-7.1777e-02, -7.1777e-02],
         ...,
         [-1.2207e-04, -1.2207e-04],
         [-1.5259e-04, -1.5259e-04],
         [-1.8311e-04, -1.8311e-04]],

        [[ 2.3804e-03,  2.3804e-03],
         [ 2.2583e-03,  2.2583e-03],
         [ 2.1667e-03,  2.1667e-03],
         ...,
         [ 4.3030e-03,  4.3030e-03],
         [ 4.2725e-03,  4.2725e-03],
         [ 4.2419e-03,  4.2419e-03]],

        [[-2.0569e-02, -2.0569e-02],
         [-2.0905e-02, -2.0905e-02],
         [-2.1240e-02, -2.1240e-02],
         ...,
         [ 3.2043e-03,  3.2043e-03],
         [ 2.9907e-03,  2.9907e-03],
         [ 2.6855e-03,  2.6855e-03]]])
2/? [00:02<00:00,  1.47s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[-0.1018, -0.1018],
         [-0.0842, -0.0842],
         [-0.0669, -0.0669],
         ...,
         [-0.0145, -0.0145],
         [-0.0247, -0.0247],
         [-0.0308, -0.0308]],

        [[ 0.1429,  0.1429],
         [ 0.1578,  0.1578],
         [ 0.1672,  0.1672],
         ...,
         [-0.0059, -0.0059],
         [-0.0068, -0.0068],
         [-0.0077, -0.0077]],

        [[ 0.1626,  0.1626],
         [ 0.1553,  0.1553],
         [ 0.1378,  0.1378],
         ...,
         [ 0.0248,  0.0248],
         [ 0.0240,  0.0240],
         [ 0.0194,  0.0194]],

        [[ 0.3035,  0.3035],
         [ 0.2960,  0.2960],
         [ 0.2777,  0.2777],
         ...,
         [-0.4805, -0.4805],
         [-0.4367, -0.4367],
         [-0.3481, -0.3481]],

        [[-0.0896, -0.0896],
         [-0.0692, -0.0692],
         [-0.0460, -0.0460],
         ...,
         [-0.1915, -0.1915],
         [-0.1959, -0.1959],
         [-0.1994, -0.1994]],

        [[ 0.0018,  0.0018],
         [ 0.0027,  0.0027],
         [ 0.0027,  0.0027],
         ...,
         [-0.0924, -0.0924],
         [-0.1119, -0.1119],
         [-0.1242, -0.1242]]])
Y istensor([[[ 2.0386e-02,  2.0386e-02],
         [ 2.2217e-02,  2.2217e-02],
         [ 2.2583e-02,  2.2583e-02],
         ...,
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05],
         [ 3.0518e-05,  3.0518e-05]],

        [[ 1.4526e-02,  1.4526e-02],
         [ 3.0121e-02,  3.0121e-02],
         [ 4.5349e-02,  4.5349e-02],
         ...,
         [ 3.4515e-02,  3.4515e-02],
         [ 3.3020e-02,  3.3020e-02],
         [ 3.1311e-02,  3.1311e-02]],

        [[ 1.2369e-01,  1.2369e-01],
         [ 1.0751e-01,  1.0751e-01],
         [ 8.8165e-02,  8.8165e-02],
         ...,
         [-7.9346e-04, -7.9346e-04],
         [-9.1553e-04, -9.1553e-04],
         [-1.2207e-03, -1.2207e-03]],

        [[-1.2024e-02, -1.2024e-02],
         [ 1.3489e-02,  1.3489e-02],
         [ 4.2694e-02,  4.2694e-02],
         ...,
         [-1.5137e-02, -1.5137e-02],
         [-1.2390e-02, -1.2390e-02],
         [-1.0406e-02, -1.0406e-02]],

        [[-3.0518e-04, -3.0518e-04],
         [-2.4414e-04, -2.4414e-04],
         [-2.1362e-04, -2.1362e-04],
         ...,
         [-2.6733e-02, -2.6733e-02],
         [-2.6703e-02, -2.6703e-02],
         [-2.6611e-02, -2.6611e-02]],

        [[ 2.4323e-02,  2.4323e-02],
         [ 2.4933e-02,  2.4933e-02],
         [ 2.5391e-02,  2.5391e-02],
         ...,
         [ 3.0518e-05,  3.0518e-05],
         [ 6.1035e-05,  6.1035e-05],
         [ 6.1035e-05,  6.1035e-05]]])
3/? [00:03<00:00,  1.31s/it]3/? [00:03<00:00,  1.22s/it]
Train recons_loss_l1: 0.2322 spectral_loss_l1: 0.4308 multispectral_loss_l1: 0.2796 recons_loss: 0.2322 spectral_loss: 0.4308 multispectral_loss: 0.2796 spectral_convergence: 2.3243 l2_loss: 0.1724 l1_loss: 0.4253 linf_loss: 2.9898 commit_loss: 0.0089 fit: 0.5697 pn: 0.2356 entropy: 0.0000 used_curr: 0.5000 usage: 1024.0000 dk: 0.0001 loss: 0.5119 gn: 15.2849 lr: 0.0001 lg_loss_scale: 0.0000 epoch: 6.0000
Epoch:  7 / 350
tensor([[[ 0.1140,  0.1140],
         [ 0.1238,  0.1238],
         [ 0.1275,  0.1275],
         ...,
         [-0.0745, -0.0745],
         [-0.0776, -0.0776],
         [-0.0791, -0.0791]],

        [[-0.1790, -0.1790],
         [-0.1892, -0.1892],
         [-0.1947, -0.1947],
         ...,
         [ 0.1430,  0.1430],
         [ 0.1287,  0.1287],
         [ 0.1136,  0.1136]],

        [[-0.1279, -0.1279],
         [-0.1372, -0.1372],
         [-0.1427, -0.1427],
         ...,
         [ 0.1047,  0.1047],
         [ 0.0757,  0.0757],
         [ 0.0523,  0.0523]],

        [[-0.0027, -0.0027],
         [ 0.0008,  0.0008],
         [ 0.0034,  0.0034],
         ...,
         [-0.0612, -0.0612],
         [-0.0392, -0.0392],
         [-0.0255, -0.0255]],

        [[-0.0919, -0.0919],
         [-0.0963, -0.0963],
         [-0.1012, -0.1012],
         ...,
         [ 0.0372,  0.0372],
         [ 0.0459,  0.0459],
         [ 0.0524,  0.0524]],

        [[ 0.0399,  0.0399],
         [ 0.0375,  0.0375],
         [ 0.0359,  0.0359],
         ...,
         [ 0.0419,  0.0419],
         [ 0.0443,  0.0443],
         [ 0.0467,  0.0467]]])
tensor([[[ 0.0010,  0.0010],
         [ 0.0036,  0.0036],
         [ 0.0060,  0.0060],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]],

        [[-0.0597, -0.0597],
         [-0.0581, -0.0581],
         [-0.0596, -0.0596],
         ...,
         [ 0.0002,  0.0002],
         [ 0.0001,  0.0001],
         [-0.0013, -0.0013]],

        [[ 0.0674,  0.0674],
         [ 0.0767,  0.0767],
         [ 0.0876,  0.0876],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]],

        [[-0.0101, -0.0101],
         [-0.0158, -0.0158],
         [-0.0202, -0.0202],
         ...,
         [ 0.0266,  0.0266],
         [ 0.0352,  0.0352],
         [ 0.0496,  0.0496]],

        [[-0.0129, -0.0129],
         [-0.0138, -0.0138],
         [-0.0153, -0.0153],
         ...,
         [ 0.0002,  0.0002],
         [ 0.0002,  0.0002],
         [ 0.0003,  0.0003]],

        [[ 0.0021,  0.0021],
         [ 0.0004,  0.0004],
         [-0.0010, -0.0010],
         ...,
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000],
         [ 0.0000,  0.0000]]])
0/? [00:00<?, ?it/s]Debug info - i: 0, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0000e+00,  0.0000e+00],
         [-1.4954e-03, -1.4954e-03],
         [-2.6245e-03, -2.6245e-03],
         ...,
         [-8.6670e-02, -8.6670e-02],
         [-1.0532e-01, -1.0532e-01],
         [-1.2329e-01, -1.2329e-01]],

        [[-1.2115e-01, -1.2115e-01],
         [-1.6815e-01, -1.6815e-01],
         [-2.0563e-01, -2.0563e-01],
         ...,
         [ 5.6763e-03,  5.6763e-03],
         [ 5.2795e-03,  5.2795e-03],
         [ 8.1177e-03,  8.1177e-03]],

        [[-4.1199e-03, -4.1199e-03],
         [-2.0142e-03, -2.0142e-03],
         [-1.5259e-04, -1.5259e-04],
         ...,
         [-3.2043e-03, -3.2043e-03],
         [-3.4180e-03, -3.4180e-03],
         [-3.7537e-03, -3.7537e-03]],

        [[-7.1106e-03, -7.1106e-03],
         [-7.4463e-03, -7.4463e-03],
         [-7.7209e-03, -7.7209e-03],
         ...,
         [-8.8013e-02, -8.8013e-02],
         [-7.7454e-02, -7.7454e-02],
         [-7.4310e-02, -7.4310e-02]],

        [[-8.4137e-02, -8.4137e-02],
         [-8.5083e-02, -8.5083e-02],
         [-8.0902e-02, -8.0902e-02],
         ...,
         [-1.1139e-01, -1.1139e-01],
         [-1.2073e-01, -1.2073e-01],
         [-1.3818e-01, -1.3818e-01]],

        [[-1.4221e-01, -1.4221e-01],
         [-1.0745e-01, -1.0745e-01],
         [-6.5613e-02, -6.5613e-02],
         ...,
         [ 1.8027e-01,  1.8027e-01],
         [ 1.8805e-01,  1.8805e-01],
         [ 1.7371e-01,  1.7371e-01]]])
Y istensor([[[ 4.6997e-03,  4.6997e-03],
         [ 5.4932e-03,  5.4932e-03],
         [ 6.3782e-03,  6.3782e-03],
         ...,
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05],
         [-6.1035e-05, -6.1035e-05]],

        [[ 2.1942e-02,  2.1942e-02],
         [ 2.9388e-02,  2.9388e-02],
         [ 3.1464e-02,  3.1464e-02],
         ...,
         [-1.0590e-02, -1.0590e-02],
         [-1.2177e-02, -1.2177e-02],
         [-1.3763e-02, -1.3763e-02]],

        [[-2.6550e-03, -2.6550e-03],
         [-3.0518e-03, -3.0518e-03],
         [-3.1433e-03, -3.1433e-03],
         ...,
         [ 7.4463e-03,  7.4463e-03],
         [ 4.9438e-03,  4.9438e-03],
         [ 5.0964e-03,  5.0964e-03]],

        [[-3.0670e-02, -3.0670e-02],
         [-3.2532e-02, -3.2532e-02],
         [-3.5034e-02, -3.5034e-02],
         ...,
         [-8.4808e-02, -8.4808e-02],
         [-7.7271e-02, -7.7271e-02],
         [-6.7963e-02, -6.7963e-02]],

        [[-1.0681e-03, -1.0681e-03],
         [ 2.7466e-04,  2.7466e-04],
         [ 1.0071e-03,  1.0071e-03],
         ...,
         [-4.4128e-02, -4.4128e-02],
         [-3.9886e-02, -3.9886e-02],
         [-3.5553e-02, -3.5553e-02]],

        [[-1.8311e-04, -1.8311e-04],
         [-1.8311e-04, -1.8311e-04],
         [-1.8311e-04, -1.8311e-04],
         ...,
         [-4.1412e-02, -4.1412e-02],
         [-3.3905e-02, -3.3905e-02],
         [-2.1118e-02, -2.1118e-02]]])
1/? [00:01<00:00,  2.00s/it]Debug info - i: 1, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 1.4954e-03,  1.4954e-03],
         [-7.7515e-03, -7.7515e-03],
         [ 5.8899e-03,  5.8899e-03],
         ...,
         [ 9.0759e-02,  9.0759e-02],
         [ 4.1626e-02,  4.1626e-02],
         [-6.4087e-04, -6.4087e-04]],

        [[-4.2725e-04, -4.2725e-04],
         [-3.9673e-04, -3.9673e-04],
         [-3.3569e-04, -3.3569e-04],
         ...,
         [ 2.0755e-01,  2.0755e-01],
         [ 2.1793e-01,  2.1793e-01],
         [ 2.2903e-01,  2.2903e-01]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-1.1322e-02, -1.1322e-02],
         [-4.6387e-03, -4.6387e-03],
         [ 2.5940e-03,  2.5940e-03]],

        [[-5.5847e-03, -5.5847e-03],
         [-1.2207e-04, -1.2207e-04],
         [ 5.3406e-03,  5.3406e-03],
         ...,
         [-2.7487e-01, -2.7487e-01],
         [-2.5882e-01, -2.5882e-01],
         [-2.2922e-01, -2.2922e-01]],

        [[ 6.4911e-02,  6.4911e-02],
         [ 6.1584e-02,  6.1584e-02],
         [ 5.7129e-02,  5.7129e-02],
         ...,
         [-7.7209e-03, -7.7209e-03],
         [ 1.1597e-03,  1.1597e-03],
         [ 9.8572e-03,  9.8572e-03]],

        [[ 2.1973e-03,  2.1973e-03],
         [ 2.4414e-04,  2.4414e-04],
         [-3.1128e-03, -3.1128e-03],
         ...,
         [ 4.4800e-02,  4.4800e-02],
         [ 3.9642e-02,  3.9642e-02],
         [ 3.2501e-02,  3.2501e-02]]])
Y istensor([[[ 1.5717e-02,  1.5717e-02],
         [ 1.1566e-02,  1.1566e-02],
         [ 7.1716e-03,  7.1716e-03],
         ...,
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05]],

        [[-6.1035e-05, -6.1035e-05],
         [-9.1553e-05, -9.1553e-05],
         [-9.1553e-05, -9.1553e-05],
         ...,
         [ 1.9684e-02,  1.9684e-02],
         [ 2.0264e-02,  2.0264e-02],
         [ 1.7456e-02,  1.7456e-02]],

        [[-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-5.7373e-02, -5.7373e-02],
         [-5.6061e-02, -5.6061e-02],
         [-5.5817e-02, -5.5817e-02]],

        [[ 2.0142e-03,  2.0142e-03],
         [ 2.0142e-03,  2.0142e-03],
         [ 1.5259e-04,  1.5259e-04],
         ...,
         [ 1.3397e-02,  1.3397e-02],
         [ 9.0942e-03,  9.0942e-03],
         [ 4.3030e-03,  4.3030e-03]],

        [[ 1.1438e-01,  1.1438e-01],
         [ 1.1783e-01,  1.1783e-01],
         [ 1.0892e-01,  1.0892e-01],
         ...,
         [-1.4954e-03, -1.4954e-03],
         [-1.8616e-03, -1.8616e-03],
         [-1.5869e-03, -1.5869e-03]],

        [[ 3.4058e-02,  3.4058e-02],
         [ 2.7985e-02,  2.7985e-02],
         [ 2.1606e-02,  2.1606e-02],
         ...,
         [ 8.5144e-03,  8.5144e-03],
         [ 3.2654e-03,  3.2654e-03],
         [-3.2349e-03, -3.2349e-03]]])
2/? [00:02<00:00,  1.68s/it]Debug info - i: 2, original_data type: <class 'torch.Tensor'>, stem_data type: <class 'torch.Tensor'>
X is tensor([[[ 0.0482,  0.0482],
         [ 0.0500,  0.0500],
         [ 0.0516,  0.0516],
         ...,
         [ 0.0013,  0.0013],
         [ 0.0018,  0.0018],
         [ 0.0021,  0.0021]],

        [[ 0.0147,  0.0147],
         [-0.0063, -0.0063],
         [-0.0302, -0.0302],
         ...,
         [-0.0425, -0.0425],
         [-0.0107, -0.0107],
         [-0.0186, -0.0186]],

        [[ 0.0118,  0.0118],
         [ 0.0255,  0.0255],
         [ 0.0328,  0.0328],
         ...,
         [ 0.2883,  0.2883],
         [ 0.2793,  0.2793],
         [ 0.2478,  0.2478]],

        [[-0.0288, -0.0288],
         [-0.0234, -0.0234],
         [-0.0171, -0.0171],
         ...,
         [ 0.0016,  0.0016],
         [ 0.0018,  0.0018],
         [ 0.0016,  0.0016]],

        [[ 0.0193,  0.0193],
         [ 0.0235,  0.0235],
         [ 0.0255,  0.0255],
         ...,
         [ 0.0347,  0.0347],
         [ 0.0187,  0.0187],
         [ 0.0069,  0.0069]],

        [[ 0.0550,  0.0550],
         [ 0.0607,  0.0607],
         [ 0.0603,  0.0603],
         ...,
         [-0.0399, -0.0399],
         [-0.0291, -0.0291],
         [-0.0282, -0.0282]]])
Y istensor([[[-1.4893e-02, -1.4893e-02],
         [-1.5625e-02, -1.5625e-02],
         [-1.6205e-02, -1.6205e-02],
         ...,
         [ 1.1932e-02,  1.1932e-02],
         [ 6.8970e-03,  6.8970e-03],
         [ 6.7139e-04,  6.7139e-04]],

        [[-9.4604e-04, -9.4604e-04],
         [-1.2207e-03, -1.2207e-03],
         [-1.2817e-03, -1.2817e-03],
         ...,
         [ 1.7700e-02,  1.7700e-02],
         [ 1.4038e-02,  1.4038e-02],
         [ 1.2085e-02,  1.2085e-02]],

        [[ 3.3295e-02,  3.3295e-02],
         [-5.5542e-03, -5.5542e-03],
         [-2.2705e-02, -2.2705e-02],
         ...,
         [ 1.9897e-02,  1.9897e-02],
         [ 1.6449e-02,  1.6449e-02],
         [ 1.3489e-02,  1.3489e-02]],

        [[-9.0637e-03, -9.0637e-03],
         [-2.6642e-02, -2.6642e-02],
         [-2.7832e-02, -2.7832e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-3.0518e-05, -3.0518e-05],
         [ 0.0000e+00,  0.0000e+00],
         [-3.0518e-05, -3.0518e-05],
         ...,
         [-3.0884e-02, -3.0884e-02],
         [-1.1108e-02, -1.1108e-02],
         [ 1.0742e-02,  1.0742e-02]],

srun: Job step aborted: Waiting up to 17 seconds for job step to finish.
        [[ 3.0823e-03,  3.0823e-03],
slurmstepd: error: *** JOB 32719 ON toga CANCELLED AT 2023-11-04T18:23:47 ***
Job ID: 32719
Cluster: crimson
User/Group: IS460G10/IS460G10
State: CANCELLED (exit code 0)
Nodes: 1
Cores per node: 4
CPU Utilized: 00:05:16
CPU Efficiency: 57.66% of 00:09:08 core-walltime
Job Wall-clock time: 00:02:17
Memory Utilized: 31.03 GB
Memory Efficiency: 193.91% of 16.00 GB
